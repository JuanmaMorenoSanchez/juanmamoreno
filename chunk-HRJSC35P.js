import{a as ve,b as we}from"./chunk-YOD6BMGO.js";import{a as F,b as Ve}from"./chunk-5B2JW5CN.js";import{b as ce,d as me,e as pe}from"./chunk-GHCUGPDX.js";import{c as Y,d as ge,e as he}from"./chunk-GPT6AVAW.js";import{a as _e}from"./chunk-HZMOVPMG.js";import{a as Ce,b as E,c as ye,d as Ie,e as ke,f as xe,g as Te,h as Me,l as be}from"./chunk-DOEGVLUF.js";import"./chunk-DSUZDOMH.js";import"./chunk-3TOVUA2N.js";import{h as O,j,k as N,m as fe,n as f}from"./chunk-XEH6PUWV.js";import{Fa as ue,Ha as q,aa as de,e as b}from"./chunk-N6MMC3M5.js";import{i as le}from"./chunk-WT6TTWCM.js";import{$b as ie,Aa as X,B as G,Ba as V,Ea as I,Eb as d,Ec as M,Fb as ee,Fc as U,Gb as te,I as $,Kb as u,Ob as r,Pb as a,Qb as k,Sb as x,T as W,Ub as p,Vb as C,W as J,Yb as S,ab as B,ac as ne,bc as oe,cb as o,ea as v,fc as s,gc as A,hb as Q,hc as R,ic as re,jc as ae,la as K,m as H,ma as g,na as h,ob as w,oc as se,pc as z,q as L,qc as l,rb as Z,rc as y,sc as T,ub as m}from"./chunk-6QHYPLKR.js";import"./chunk-FK6H3RFT.js";import"./chunk-4X36HX5K.js";function Le(t,_){t&1&&(r(0,"mat-icon"),s(1,"download"),a())}function Ae(t,_){t&1&&k(0,"mat-progress-spinner",1)}var Pe=(()=>{class t{constructor(){this.link=V(),this.name=V(),this.isDownloading=!1}downloadImage(){this.isDownloading=!0,fetch(this.link()).then(e=>{if(!e.ok)throw new Error("Failed to fetch the image.");return e.blob()}).then(e=>{let i=URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download=`${this.name()}.jpg`,n.click(),URL.revokeObjectURL(i)}).catch(e=>{console.error("Error downloading the image:",e)}).finally(()=>{this.isDownloading=!1})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-download-button"]],inputs:{link:[1,"link"],name:[1,"name"]},decls:4,vars:5,consts:[["mat-icon-button","","matTooltipPosition","below",3,"click","disabled","matTooltip"],["diameter","24","mode","indeterminate"]],template:function(i,n){i&1&&(r(0,"button",0),l(1,"translate"),p("click",function(){return n.downloadImage()}),m(2,Le,2,0,"mat-icon")(3,Ae,1,0,"mat-progress-spinner",1),a()),i&2&&(S("matTooltip",y(1,3,"download.hd")),d("disabled",n.isDownloading),o(2),u(n.isDownloading?3:2))},dependencies:[q,E,O,Ce,b],encapsulation:2})}}return t})();var De=["imageElement"];function Be(t,_){if(t&1){let e=x();r(0,"div",7),p("click",function(){g(e);let n=C();return h(n.nextNft(-1))}),r(1,"mat-icon",8),s(2," arrow_back "),a()()}}function Re(t,_){t&1&&(r(0,"mat-icon",5),s(1," fullscreen "),a())}function Ue(t,_){if(t&1){let e=x();r(0,"div",9),p("click",function(){g(e);let n=C();return h(n.nextNft(1))}),r(1,"mat-icon",8),s(2," arrow_forward "),a()()}}var Se=(()=>{class t{constructor(){this.artworkInfraService=v(F),this.nfts=V([]),this.displayIndex=I(0),this.previewImage=I("none"),this.isFullScreen=I(!1),this.displayIndexOutput=X({alias:"displayIndex"}),this.hovering=!1,this.displayArrows=!1,this.displayExpand=!1,this.isImgVisible=!1,U(()=>{let e=this.nfts(),i=this.displayIndex(),n=this.isFullScreen();this.artworkInfraService.getAvailableOptimalUrl(e[i]).subscribe(c=>{this.previewImage.set(n?"none":`url(${c})`)})})}ngOnInit(){this.displayIndex.set(f.getLatestVersionIndex(this.nfts()))}ngOnChanges(e){this.displayArrows=e.nfts.currentValue.length>1,this.isImgVisible=!1,this.displayIndexOutput.emit(f.getLatestVersionIndex(this.nfts())),this.displayIndex.set(f.getLatestVersionIndex(this.nfts()))}setHover(e){this.hovering=e}nextNft(e){this.isImgVisible=!1;let i=(this.displayIndex()+e+this.nfts().length)%this.nfts().length;this.displayIndexOutput.emit(i),this.displayIndex.set(i)}imageLoad(){this.isImgVisible=!0}getQualityImg(e){return f.getNftQualityUrl(e?.image)}handleImageClick(){this.displayExpand?this.enterFullScreen():this.isFullScreen()?this.exitFullScreen():(this.displayExpand=!0,setTimeout(()=>{this.displayExpand=!1},2e3))}handleDoubleClick(){this.isFullScreen()||this.enterFullScreen()}enterFullScreen(){this.isFullScreen.set(!0);let e=this.imageElement.nativeElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}exitFullScreen(){this.isFullScreen.set(!1),document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-image-viewer"]],viewQuery:function(i,n){if(i&1&&ie(De,5),i&2){let c;ne(c=oe())&&(n.imageElement=c.first)}},inputs:{nfts:[1,"nfts"]},outputs:{displayIndexOutput:"displayIndex"},features:[K],decls:7,vars:6,consts:[["imageElement",""],[1,"image-viewer",3,"mouseover","mouseleave"],[1,"overlay","left"],[1,"image-container",3,"click","dblclick"],[1,"art-viewer",3,"load","src"],[1,"fullscreen-icon"],[1,"overlay","right"],[1,"overlay","left",3,"click"],[1,"arrow"],[1,"overlay","right",3,"click"]],template:function(i,n){if(i&1){let c=x();r(0,"div",1),p("mouseover",function(){return g(c),h(n.setHover(!0))})("mouseleave",function(){return g(c),h(n.setHover(!1))}),m(1,Be,3,0,"div",2),r(2,"div",3),p("click",function(){return g(c),h(n.handleImageClick())})("dblclick",function(){return g(c),h(n.handleDoubleClick())}),r(3,"img",4,0),p("load",function(){return g(c),h(n.imageLoad())}),a(),m(5,Re,2,0,"mat-icon",5),a(),m(6,Ue,3,0,"div",6),a()}i&2&&(o(),u(n.displayArrows&&n.hovering?1:-1),o(2),ee("background-image",n.previewImage()),d("src",n.getQualityImg(n.nfts()[n.displayIndex()]),B),o(2),u(n.displayExpand?5:-1),o(),u(n.displayArrows&&n.hovering?6:-1))},dependencies:[O],styles:[".image-viewer[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.image-viewer[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{max-width:100%;max-height:100%;background-repeat:no-repeat;background-size:100% 100%;cursor:pointer}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:20%;background-color:#ffffff1a;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1;transition:background-color .3s}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]:hover{background-color:#fff6}.image-viewer[_ngcontent-%COMP%]   .overlay.left[_ngcontent-%COMP%]{left:0}.image-viewer[_ngcontent-%COMP%]   .overlay.right[_ngcontent-%COMP%]{right:0}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:#fff;opacity:.8;transition:transform .3s,opacity .3s}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]:hover{transform:scale(1.2);opacity:1}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;background-color:#d3d3d3}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .fullscreen-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;z-index:2;display:none;align-items:center;justify-content:center;pointer-events:none}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]:hover   .fullscreen-icon[_ngcontent-%COMP%]{display:flex}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]{background-color:#000;display:flex;align-items:center;justify-content:center;z-index:3}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{background-color:#000;max-width:100vw;max-height:100vh}"]})}}return t})();function je(t,_){if(t&1&&(r(0,"mat-list-item")(1,"a",5),s(2),a()()),t&2){let e=_.$implicit;o(),d("href",e,B),o(),R(" ",e.replace("https://","").replace("http://","").replace("www.","")," ")}}var Oe=(()=>{class t{constructor(e,i){this.data=e,this.dialogRef=i}close(){this.dialogRef.close()}static{this.\u0275fac=function(i){return new(i||t)(Q(Ie),Q(ye))}}static{this.\u0275cmp=w({type:t,selectors:[["app-links-modal"]],decls:9,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-line","","target","_blank","rel","noopener noreferrer",3,"href"]],template:function(i,n){i&1&&(r(0,"h1",0),s(1),l(2,"translate"),a(),r(3,"div",1)(4,"mat-list"),m(5,je,3,2,"mat-list-item",2),a()(),r(6,"div",3)(7,"button",4),p("click",function(){return n.close()}),s(8,"Close"),a()()),i&2&&(o(),A(y(2,2,"links.view")),o(4),d("ngForOf",n.data.links))},dependencies:[xe,Te,ve,le,we,de,Me,ue,b],encapsulation:2})}}return t})();function Ne(t,_){if(t&1){let e=x();r(0,"button",1),l(1,"translate"),p("click",function(){g(e);let n=C();return h(n.openLinksModal())}),r(2,"mat-icon"),s(3,"link"),a()()}t&2&&S("matTooltip",y(1,1,"links.view"))}var Ee=(()=>{class t{constructor(){this.artworkInfraService=v(F),this.dialog=v(ke),this.tokenId=V(),this.haveLinks=I(!1),this.rxUrls=ge({request:()=>this.tokenId(),loader:({request:e})=>this.artworkInfraService.getLinks(e).pipe($(),L(i=>i||[]),G(()=>H([])))}),U(()=>{let i=this.rxUrls.value()?.urls;this.haveLinks.set(Array.isArray(i)&&i.length>0)})}openLinksModal(){let e=this.rxUrls.value();this.dialog.open(Oe,{data:{links:e?.urls}})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-links-button"]],inputs:{tokenId:[1,"tokenId"]},decls:1,vars:1,consts:[["mat-icon-button","","matTooltipPosition","below",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","below",3,"click","matTooltip"]],template:function(i,n){i&1&&m(0,Ne,4,3,"button",0),i&2&&u(n.haveLinks()?0:-1)},dependencies:[q,E,O,b],encapsulation:2})}}return t})();var Fe=(()=>{class t{transform(e,i){return e?f.getTraitValue(e,i):""}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=Z({name:"trait",type:t,pure:!0})}}return t})();var qe=()=>["/artworks"],Ye=t=>({years:t}),Qe=t=>[t];function ze(t,_){t&1&&(k(0,"span",5),l(1,"translate")),t&2&&S("matTooltip",y(1,1,"sold"))}function He(t,_){if(t&1&&k(0,"app-pdf-button",7),t&2){let e=C(2);d("nfts",z(1,Qe,e.frontalViewNft()))}}function Ge(t,_){if(t&1&&(r(0,"div",3)(1,"h1")(2,"i"),s(3),r(4,"small"),s(5),a()()(),r(6,"h2")(7,"small")(8,"a",4),l(9,"trait"),s(10),l(11,"trait"),a(),s(12),l(13,"trait"),l(14,"translate"),l(15,"trait"),l(16,"trait"),l(17,"trait"),m(18,ze,2,3,"span",5),a()(),r(19,"small"),k(20,"app-download-button",6),m(21,He,1,3,"app-pdf-button",7),k(22,"app-links-button",8),a()()),t&2){let e=C();o(3),R("",e.nft().name,". "),o(2),A(e.viewLabel()),o(3),d("routerLink",se(34,qe))("queryParams",z(35,Ye,T(9,14,e.nft(),e.validTraits.YEAR))),o(2),A(T(11,17,e.nft(),e.validTraits.YEAR)),o(2),ae(", ",y(14,23,T(13,20,e.nft(),e.validTraits.MEDIUM)),", ",T(15,25,e.nft(),e.validTraits.HEIGHT)," x ",T(16,28,e.nft(),e.validTraits.WIDTH)," ",T(17,31,e.nft(),e.validTraits.UNIT),". "),o(6),u(e.sold()?18:-1),o(2),d("link",e.qualityImg())("name",e.nft().name),o(),u(e.frontalViewNft()?21:-1),o(),d("tokenId",e.nft().tokenId)}}function $e(t,_){if(t&1){let e=x();k(0,"mat-divider"),r(1,"p"),s(2),l(3,"translate"),l(4,"trait"),a(),r(5,"app-art-pieces-list",9),p("selectedTokenId",function(n){g(e);let c=C();return h(c.handleSelectedItem(n))}),a()}if(t&2){let e=C();o(2),re(" ",y(3,5,"moreOn")," ",T(4,7,e.nft(),e.validTraits.YEAR)," "),o(3),d("viewAsWidget",!0)("numberOfCols",e.numberOfViewMoreColumns())("nftFilters",e.getSameYearListFilter())}}var Jt=(()=>{class t{constructor(){this.router=v(me),this.route=v(ce),this.artworkService=v(F),this.responsiveService=v(he),this.validTraits=j,this.numberOfViewMoreColumns=Y(this.responsiveService.displayMobileLayout.pipe(L(e=>e?6:3)),{initialValue:3}),this.displayingIndex=I(0),this.fullNftsList=Y(this.artworkService.getArtPiecesObservable()),this.nfts=Y(this.route.paramMap.pipe(L(e=>e.get("id")),W(e=>this.artworkService.getSameArtThanObservable(e)),J(e=>this.displayingIndex.set(f.getLatestVersionIndex(e)))),{initialValue:[]}),this.nft=M(()=>this.nfts()[this.displayingIndex()]),this.frontalViewNft=M(()=>this.nfts().find(e=>f.isFrontalView(e,this.nfts()))),this.thereAreMoreInYear=M(()=>{let e=f.getTraitValue(this.nft(),j.YEAR);return this.artworkService.getNftLenghtByYear(e)>1}),this.getSameYearListFilter=M(()=>({years:[this.getTraitValue(this.nft(),j.YEAR)],idsToExclude:this.nfts().map(e=>e.tokenId)})),this.viewLabel=M(()=>{let e=this.nft();if(!e)return"";let i=this.getTraitValue(e,this.validTraits.IMAGETYPE);return i===N.PROGRESS||i===N.DETAIL?`(${i})`:this.displayingIndex()===f.getLatestVersionIndex(this.nfts())?"":`(${N.PROGRESS})`}),this.qualityImg=M(()=>f.getNftQualityUrl(this.nft().image)),this.sold=M(()=>fe.includes(this.nft().tokenId)),this.isFading=I(!1)}getTraitValue(e,i){return f.getTraitValue(e,i)}indexChanged(e){this.isFading.set(!0),setTimeout(()=>{this.displayingIndex.set(e),window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>this.isFading.set(!1),300)},150)}handleSelectedItem(e){this.router.navigate(["/art",e])}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-art-piece"]],decls:5,vars:5,consts:[[1,"container","margin-top"],[1,"fade-container"],[1,"fit-width",3,"displayIndex","nfts"],[1,"art-piece-labels"],[3,"routerLink","queryParams"],[1,"dot",3,"matTooltip"],[3,"link","name"],[3,"nfts"],[3,"tokenId"],[3,"selectedTokenId","viewAsWidget","numberOfCols","nftFilters"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"app-image-viewer",2),p("displayIndex",function(P){return n.indexChanged(P)}),a(),m(3,Ge,23,37,"div",3),a(),m(4,$e,6,10),a()),i&2&&(o(),te("fade-out",n.isFading()),o(),d("nfts",n.nfts()),o(),u(n.nft()?3:-1),o(),u(n.thereAreMoreInYear()?4:-1))},dependencies:[Se,pe,E,Pe,be,Ee,_e,Ve,b,Fe],styles:[".dot[_ngcontent-%COMP%]{height:1rem;width:1rem;background-color:#cf2525;border-radius:50%;display:inline-block;margin-left:.8rem;vertical-align:middle}.art-piece-labels[_ngcontent-%COMP%]{padding:8%;text-align:center}.art-piece-desc[_ngcontent-%COMP%]{white-space:pre-line}.fade-container[_ngcontent-%COMP%]{transition:opacity .3s ease-in-out;opacity:1}.fade-container.fade-out[_ngcontent-%COMP%]{opacity:0}"]})}}return t})();export{Jt as ArtPieceComponent};
