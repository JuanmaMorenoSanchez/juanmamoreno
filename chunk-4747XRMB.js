import{a as ve,b as _e}from"./chunk-PHAGXH7W.js";import{a as Me}from"./chunk-2JVGIAJQ.js";import{b as se,d as le,e as ce}from"./chunk-UUJUUSO5.js";import{b as N,c as ue,d as fe}from"./chunk-EKHLUWSP.js";import{a as he}from"./chunk-EMXHCF6U.js";import{a as we,b as V,c as Ce,d as ke,e as ye,f as Ie,g as xe,h as Te,l as be}from"./chunk-O7JLKHVY.js";import"./chunk-ZODY27AD.js";import"./chunk-IENCGX2L.js";import{h as E,i as P,l as U,m as j,o as ge}from"./chunk-BEVEE7IB.js";import{Fa as de,Ha as q,aa as me,d as pe,e as S}from"./chunk-BKOE4B3O.js";import{i as ae}from"./chunk-6YHBLYQ2.js";import{$b as ie,Aa as K,B as H,Ba as x,Cc as v,Db as T,Dc as O,Ea as f,Eb as c,Fb as X,Gb as Z,I as Q,Kb as g,Ob as r,Pb as a,Qb as y,Sb as b,T as G,Ub as m,Vb as I,W as $,Zb as ee,_b as te,ab as B,cb as o,dc as l,ea as u,ec as L,fc as A,gc as ne,hb as Y,hc as oe,m as z,ma as w,mc as re,na as C,nc as W,ob as k,oc as s,pc as d,q as D,qc as M,rb as J,ub as p}from"./chunk-T7XUK2UF.js";import"./chunk-FK6H3RFT.js";import"./chunk-4X36HX5K.js";function Fe(i,_){i&1&&(r(0,"mat-icon"),l(1,"download"),a())}function De(i,_){i&1&&y(0,"mat-progress-spinner",1)}var Se=(()=>{class i{constructor(){this.link=x(),this.name=x(),this.isDownloading=!1}downloadImage(){this.isDownloading=!0,fetch(this.link()).then(e=>{if(!e.ok)throw new Error("Failed to fetch the image.");return e.blob()}).then(e=>{let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`${this.name()}.jpg`,n.click(),URL.revokeObjectURL(t)}).catch(e=>{console.error("Error downloading the image:",e)}).finally(()=>{this.isDownloading=!1})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=k({type:i,selectors:[["app-download-button"]],inputs:{link:[1,"link"],name:[1,"name"]},decls:5,vars:8,consts:[["mat-icon-button","","matTooltipPosition","below",3,"click","disabled","matTooltip"],["diameter","24","mode","indeterminate"]],template:function(t,n){t&1&&(r(0,"button",0),s(1,"translate"),s(2,"translate"),m("click",function(){return n.downloadImage()}),p(3,Fe,2,0,"mat-icon")(4,De,1,0,"mat-progress-spinner",1),a()),t&2&&(c("disabled",n.isDownloading)("matTooltip",d(1,4,"download.hd")),T("aria-label",d(2,6,"download.hd")),o(3),g(n.isDownloading?4:3))},dependencies:[q,V,E,we,S],encapsulation:2})}}return i})();var Le=["imageElement"];function Ae(i,_){if(i&1){let e=b();r(0,"div",7),m("click",function(){w(e);let n=I();return C(n.nextNft(-1))}),r(1,"mat-icon",8),l(2," arrow_back "),a()()}}function Re(i,_){i&1&&(r(0,"mat-icon",5),l(1," fullscreen "),a())}function Be(i,_){if(i&1){let e=b();r(0,"div",9),m("click",function(){w(e);let n=I();return C(n.nextNft(1))}),r(1,"mat-icon",8),l(2," arrow_forward "),a()()}}var Pe=(()=>{class i{constructor(){this.artworkService=u(P),this.nfts=x([]),this.description=x("No description"),this.defaultDisplayIndex=0,this.currentDisplayIndex=f(this.defaultDisplayIndex),this.previewImage=f("none"),this.qualityImage=f("none"),this.isFullScreen=f(!1),this.displayIndexOutput=K({alias:"displayIndex"}),this.displayArrows=v(()=>this.nfts().length>1),this.isImgVisible=f(!0),this.hovering=!1,this.displayExpand=!1,O(()=>{let e=this.nfts()[this.currentDisplayIndex()];this.previewImage.set("none"),this.qualityImage.set("none"),this.artworkService.getAvailableOptimalUrl(e).subscribe(t=>{this.previewImage.set(this.isFullScreen()?"none":`url(${t})`)}),this.qualityImage.set(this.artworkService.getNftQualityUrl(e?.image)||"none")})}setHover(e){this.hovering=e}nextNft(e){let t=(this.currentDisplayIndex()+e+this.nfts().length)%this.nfts().length;this.displayIndexOutput.emit(t),this.currentDisplayIndex.set(t)}handleImageClick(){this.displayExpand?this.enterFullScreen():this.isFullScreen()?this.exitFullScreen():(this.displayExpand=!0,setTimeout(()=>{this.displayExpand=!1},2e3))}handleDoubleClick(){this.isFullScreen()||this.enterFullScreen()}enterFullScreen(){this.isFullScreen.set(!0);let e=this.imageElement.nativeElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}exitFullScreen(){this.isFullScreen.set(!1),document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=k({type:i,selectors:[["app-image-viewer"]],viewQuery:function(t,n){if(t&1&&ee(Le,5),t&2){let h;te(h=ie())&&(n.imageElement=h.first)}},inputs:{nfts:[1,"nfts"],description:[1,"description"]},outputs:{displayIndexOutput:"displayIndex"},decls:7,vars:8,consts:[["imageElement",""],[1,"image-viewer",3,"mouseover","mouseleave"],[1,"overlay","left"],[1,"image-container",3,"click","dblclick"],[1,"art-viewer",3,"src"],[1,"fullscreen-icon"],[1,"overlay","right"],[1,"overlay","left",3,"click"],[1,"arrow"],[1,"overlay","right",3,"click"]],template:function(t,n){if(t&1){let h=b();r(0,"div",1),m("mouseover",function(){return w(h),C(n.setHover(!0))})("mouseleave",function(){return w(h),C(n.setHover(!1))}),p(1,Ae,3,0,"div",2),r(2,"div",3),m("click",function(){return w(h),C(n.handleImageClick())})("dblclick",function(){return w(h),C(n.handleDoubleClick())}),y(3,"img",4,0),p(5,Re,2,0,"mat-icon",5),a(),p(6,Be,3,0,"div",6),a()}t&2&&(o(),g(n.displayArrows()&&n.hovering?1:-1),o(2),X("background-image",n.previewImage()),c("src",n.qualityImage(),B),T("alt",n.description())("data-key",n.isFullScreen()?null:n.currentDisplayIndex()),o(2),g(n.displayExpand?5:-1),o(),g(n.displayArrows()&&n.hovering?6:-1))},dependencies:[E],styles:[".image-viewer[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.image-viewer[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{max-width:100%;max-height:100%;background-repeat:no-repeat;background-size:100% 100%;cursor:pointer}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:20%;background-color:#ffffff1a;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]:hover{background-color:#fff6}.image-viewer[_ngcontent-%COMP%]   .overlay.left[_ngcontent-%COMP%]{left:0}.image-viewer[_ngcontent-%COMP%]   .overlay.right[_ngcontent-%COMP%]{right:0}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:#fff;opacity:.8}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]:hover{transform:scale(1.2);opacity:1}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .fullscreen-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;z-index:2;display:none;align-items:center;justify-content:center;pointer-events:none}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]:hover   .fullscreen-icon[_ngcontent-%COMP%]{display:flex}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]{background-color:#000;display:flex;align-items:center;justify-content:center;z-index:3}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{background-color:#000;max-width:100vw;max-height:100vh}"]})}}return i})();function qe(i,_){if(i&1&&(r(0,"mat-list-item")(1,"a",5),l(2),a()()),i&2){let e=_.$implicit;o(),c("href",e,B),o(),A(" ",e.replace("https://","").replace("http://","").replace("www.","")," ")}}var Oe=(()=>{class i{constructor(e,t){this.data=e,this.dialogRef=t}close(){this.dialogRef.close()}static{this.\u0275fac=function(t){return new(t||i)(Y(ke),Y(Ce))}}static{this.\u0275cmp=k({type:i,selectors:[["app-links-modal"]],decls:11,vars:10,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-line","","target","_blank","rel","noopener noreferrer",3,"href"]],template:function(t,n){t&1&&(r(0,"h2",0),l(1),s(2,"translate"),a(),r(3,"div",1)(4,"mat-list"),p(5,qe,3,2,"mat-list-item",2),a()(),r(6,"div",3)(7,"button",4),s(8,"translate"),m("click",function(){return n.close()}),l(9),s(10,"translate"),a()()),t&2&&(o(),L(d(2,4,"links.view")),o(4),c("ngForOf",n.data.links),o(2),T("aria-label",d(8,6,"close")),o(2),A(" ",d(10,8,"close")," "))},dependencies:[Ie,xe,ve,ae,_e,me,Te,de,S],encapsulation:2})}}return i})();function Ne(i,_){if(i&1){let e=b();r(0,"button",1),s(1,"translate"),s(2,"translate"),m("click",function(){w(e);let n=I();return C(n.openLinksModal())}),r(3,"mat-icon"),l(4,"link"),a()()}i&2&&(c("matTooltip",d(1,2,"links.view")),T("aria-label",d(2,4,"links.view")))}var Ee=(()=>{class i{constructor(){this.artworkService=u(P),this.dialog=u(ye),this.tokenId=x(),this.haveLinks=f(!1),this.rxUrls=ue({request:()=>this.tokenId(),loader:({request:e})=>this.artworkService.getLinks(e).pipe(Q(),D(t=>t||[]),H(()=>z([])))}),O(()=>{let t=this.rxUrls.value()?.urls;this.haveLinks.set(Array.isArray(t)&&t.length>0)})}openLinksModal(){let e=this.rxUrls.value();this.dialog.open(Oe,{data:{links:e?.urls}})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=k({type:i,selectors:[["app-links-button"]],inputs:{tokenId:[1,"tokenId"]},decls:1,vars:1,consts:[["mat-icon-button","","matTooltipPosition","below",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","below",3,"click","matTooltip"]],template:function(t,n){t&1&&p(0,Ne,5,6,"button",0),t&2&&g(n.haveLinks()?0:-1)},dependencies:[q,V,E,S],encapsulation:2})}}return i})();var Ve=(()=>{class i{constructor(){this.artworkService=u(P)}transform(e,t){return e?this.artworkService.getTraitValue(e,t):""}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=J({name:"trait",type:i,pure:!0})}}return i})();var Ue=()=>["/artworks"],je=i=>({years:i}),Ye=i=>[i];function We(i,_){i&1&&(y(0,"span",5),s(1,"translate")),i&2&&c("matTooltip",d(1,1,"sold"))}function ze(i,_){if(i&1&&y(0,"app-pdf-button",7),i&2){let e=I(2);c("nfts",W(1,Ye,e.frontalViewNft()))}}function He(i,_){if(i&1&&(r(0,"div",3)(1,"h2")(2,"i"),l(3),r(4,"small"),l(5),a()()(),r(6,"h3")(7,"small")(8,"a",4),s(9,"trait"),l(10),s(11,"trait"),a(),l(12),s(13,"trait"),s(14,"translate"),s(15,"trait"),s(16,"trait"),s(17,"trait"),p(18,We,2,3,"span",5),a()(),r(19,"small"),y(20,"app-download-button",6),p(21,ze,1,3,"app-pdf-button",7),y(22,"app-links-button",8),a()()),i&2){let e=I();o(3),A("",e.nft().name,". "),o(2),L(e.viewLabel()),o(3),c("routerLink",re(34,Ue))("queryParams",W(35,je,M(9,14,e.nft(),e.validTraits.YEAR))),o(2),L(M(11,17,e.nft(),e.validTraits.YEAR)),o(2),oe(", ",d(14,23,M(13,20,e.nft(),e.validTraits.MEDIUM)),", ",M(15,25,e.nft(),e.validTraits.HEIGHT)," x ",M(16,28,e.nft(),e.validTraits.WIDTH)," ",M(17,31,e.nft(),e.validTraits.UNIT),". "),o(6),g(e.sold()?18:-1),o(2),c("link",e.qualityImg())("name",e.nft().name),o(),g(e.frontalViewNft()?21:-1),o(),c("tokenId",e.tokenId())}}function Qe(i,_){if(i&1){let e=b();y(0,"mat-divider"),r(1,"p"),l(2),s(3,"translate"),s(4,"trait"),a(),r(5,"app-art-pieces-list",9),m("selectedTokenId",function(n){w(e);let h=I();return C(h.handleSelectedItem(n))}),a()}if(i&2){let e=I();o(2),ne("",d(3,5,"moreOn")," ",M(4,7,e.nft(),e.validTraits.YEAR),""),o(3),c("viewAsWidget",!0)("numberOfCols",e.numberOfViewMoreColumns())("nftFilters",e.getSameYearListFilter())}}var $t=(()=>{class i{constructor(){this.router=u(le),this.route=u(se),this.artworkService=u(P),this.responsiveService=u(fe),this.translateService=u(pe),this.validTraits=U,this.numberOfViewMoreColumns=N(this.responsiveService.displayMobileLayout.pipe(D(e=>e?6:3)),{initialValue:3}),this.displayingIndex=f(0),this.fullNftsList=N(this.artworkService.getArtPiecesObservable()),this.nfts=N(this.route.paramMap.pipe(D(e=>e.get("id")),G(e=>this.artworkService.getSameArtThanObservable(e)),$(e=>this.displayingIndex.set(this.artworkService.getLatestVersionIndex(e)))),{initialValue:[]}),this.nft=v(()=>this.nfts()[this.displayingIndex()]),this.tokenId=v(()=>this.nft().tokenId),this.currentLang=f(this.translateService.currentLang==="es-ES"?"es":"en"),this.descriptions=f(null),this.description=v(()=>{let e=this.descriptions(),t=this.currentLang();return this.getShortDescription(e,t)}),this.frontalViewNft=v(()=>this.nfts().find(e=>this.artworkService.isFrontalView(e,this.nfts()))),this.thereAreMoreInYear=v(()=>{let e=this.artworkService.getTraitValue(this.nft(),U.YEAR);return this.artworkService.getFullNftLenghtByYear(e)>1}),this.getSameYearListFilter=v(()=>({years:[this.getTraitValue(this.nft(),U.YEAR)],idsToExclude:this.nfts().map(e=>e.tokenId)})),this.viewLabel=v(()=>{let e=this.nft();if(!e)return"";let t=this.getTraitValue(e,this.validTraits.IMAGETYPE);return t===j.PROGRESS||t===j.DETAIL?`(${t})`:this.displayingIndex()===this.artworkService.getLatestVersionIndex(this.nfts())?"":`(${j.PROGRESS})`}),this.qualityImg=v(()=>this.artworkService.getNftQualityUrl(this.nft().image)),this.sold=v(()=>ge.includes(this.tokenId())),this.isFading=f(!1),this.translateService.onLangChange.subscribe(({lang:e})=>{this.currentLang.set(e==="es-ES"?"es":"en")}),O(()=>{let e=this.tokenId();this.artworkService.getArtPieceDescriptions(e).subscribe(t=>{this.descriptions.set(t)})})}getTraitValue(e,t){return this.artworkService.getTraitValue(e,t)}getShortDescription(e,t){return e&&e.translated.find(n=>n.lang===t)?.shortDesc||"No description available"}indexChanged(e){this.isFading.set(!0),setTimeout(()=>{this.displayingIndex.set(e),window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>this.isFading.set(!1),300)},150)}handleSelectedItem(e){this.router.navigate(["/art",e])}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=k({type:i,selectors:[["app-art-piece"]],decls:5,vars:6,consts:[[1,"container","margin-top"],[1,"fade-container"],[1,"fit-width",3,"displayIndex","nfts","description"],[1,"art-piece-labels"],[3,"routerLink","queryParams"],[1,"dot",3,"matTooltip"],[3,"link","name"],[3,"nfts"],[3,"tokenId"],[3,"selectedTokenId","viewAsWidget","numberOfCols","nftFilters"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"app-image-viewer",2),m("displayIndex",function(F){return n.indexChanged(F)}),a(),p(3,He,23,37,"div",3),a(),p(4,Qe,6,10),a()),t&2&&(o(),Z("fade-out",n.isFading()),o(),c("nfts",n.nfts())("description",n.description()),o(),g(n.nft()?3:-1),o(),g(n.thereAreMoreInYear()?4:-1))},dependencies:[Pe,ce,V,Se,be,Ee,he,Me,S,Ve],styles:[".dot[_ngcontent-%COMP%]{height:1rem;width:1rem;background-color:#cf2525;border-radius:50%;display:inline-block;margin-left:.8rem;vertical-align:middle}.art-piece-labels[_ngcontent-%COMP%]{padding:8%;text-align:center}.art-piece-desc[_ngcontent-%COMP%]{white-space:pre-line}"]})}}return i})();export{$t as ArtPieceComponent};
