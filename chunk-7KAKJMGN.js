import{Dc as p,Ea as l,Fc as h,U as g,X as b,c as m,ea as f,ka as a,ua as d}from"./chunk-T2HLDYJB.js";import{a as v,b as y}from"./chunk-AP5KEWPN.js";function w(r){r||(a(w),r=f(d));let e=new m(t=>r.onDestroy(t.next.bind(t)));return t=>t.pipe(g(e))}function k(r,e){let t=!e?.manualCleanup;t&&!e?.injector&&a(k);let u=t?e?.injector?.get(d)??f(d):null,c=x(e?.equal),o;e?.requireSync?o=l({kind:0},{equal:c}):o=l({kind:1,value:e?.initialValue},{equal:c});let i=r.subscribe({next:n=>o.set({kind:1,value:n}),error:n=>{if(e?.rejectErrors)throw n;o.set({kind:2,error:n})}});if(e?.requireSync&&o().kind===0)throw new b(601,!1);return u?.onDestroy(i.unsubscribe.bind(i)),p(()=>{let n=o();switch(n.kind){case 1:return n.value;case 2:throw n.error;case 0:throw new b(601,!1)}},{equal:e?.equal})}function x(r=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&r(e.value,t.value)}function j(r){return r?.injector||a(j),h(y(v({},r),{loader:void 0,stream:e=>{let t,u=()=>t.unsubscribe();e.abortSignal.addEventListener("abort",u);let c=l({value:void 0}),o,i=new Promise(s=>o=s);function n(s){c.set(s),o?.(c),o=void 0}return t=r.loader(e).subscribe({next:s=>n({value:s}),error:s=>n({error:s}),complete:()=>{o&&n({error:new Error("Resource completed before producing a value")}),e.abortSignal.removeEventListener("abort",u)}}),i}}))}export{w as a,k as b,j as c};
