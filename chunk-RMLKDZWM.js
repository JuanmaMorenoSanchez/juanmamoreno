import{a as me,b as pe}from"./chunk-BOUOEU6I.js";import{a as ce}from"./chunk-ACOXSBSP.js";import{a as Te}from"./chunk-LOJQ3NQO.js";import{a as he,b as P,c as ve,d as _e,e as we,f as Ce,g as Ie,h as ke,l as xe}from"./chunk-KQIIICWN.js";import{c as ue}from"./chunk-VRZSWXWQ.js";import{a as fe,b as ge}from"./chunk-5QQSRAHY.js";import"./chunk-VMCBRDLQ.js";import{c as O}from"./chunk-MWYZDPZP.js";import{b as D,c as b,e as oe,f as B,g as E}from"./chunk-5D6YHUNK.js";import{b as ye}from"./chunk-57F35MYP.js";import{H as se,b as T,ja as de,la as U}from"./chunk-V5NYV2UV.js";import{b as re,d as ae,e as le}from"./chunk-YURU66DH.js";import"./chunk-PTGSW6WY.js";import"./chunk-CFXZ5S5G.js";import{l as ne}from"./chunk-A577SA3S.js";import{Aa as W,B as H,Ba as M,Ea as _,Ec as z,Fb as c,Fc as R,Gb as J,I as Q,Lb as d,Pb as r,Qb as a,Rb as k,T as G,Tb as x,Vb as p,Wb as v,Zb as S,ab as A,ac as K,bc as X,cb as o,cc as Z,ea as f,gc as l,hb as N,hc as y,ic as L,jc as ee,kc as te,la as $,m as q,ma as g,na as h,ob as w,pc as ie,q as F,qc as Y,rc as C,sc as I,ub as m}from"./chunk-TF22FTOX.js";import"./chunk-AP5KEWPN.js";function Ee(t,u){t&1&&(r(0,"mat-icon"),l(1,"download"),a())}function Pe(t,u){t&1&&k(0,"mat-progress-spinner",1)}var Ve=(()=>{class t{constructor(){this.link=M(),this.name=M(),this.isDownloading=!1}downloadImage(){this.isDownloading=!0,fetch(this.link()).then(e=>{if(!e.ok)throw new Error("Failed to fetch the image.");return e.blob()}).then(e=>{let i=URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download=`${this.name()}.jpg`,n.click(),URL.revokeObjectURL(i)}).catch(e=>{console.error("Error downloading the image:",e)}).finally(()=>{this.isDownloading=!1})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-download-button"]],inputs:{link:[1,"link"],name:[1,"name"]},decls:4,vars:5,consts:[["mat-icon-button","","matTooltipPosition","below",3,"click","disabled","matTooltip"],["diameter","24","mode","indeterminate"]],template:function(i,n){i&1&&(r(0,"button",0),C(1,"translate"),p("click",function(){return n.downloadImage()}),m(2,Ee,2,0,"mat-icon")(3,Pe,1,0,"mat-progress-spinner",1),a()),i&2&&(S("matTooltip",I(1,3,"download.hd")),c("disabled",n.isDownloading),o(2),d(n.isDownloading?3:2))},dependencies:[U,P,E,he,T],encapsulation:2})}}return t})();var Oe=["imageElement"];function De(t,u){if(t&1){let e=x();r(0,"div",7),p("click",function(){g(e);let n=v();return h(n.nextNft(-1))}),r(1,"mat-icon",8),l(2," arrow_back "),a()()}}function Fe(t,u){t&1&&(r(0,"mat-icon",5),l(1," fullscreen "),a())}function Ae(t,u){if(t&1){let e=x();r(0,"div",9),p("click",function(){g(e);let n=v();return h(n.nextNft(1))}),r(1,"mat-icon",8),l(2," arrow_forward "),a()()}}var Me=(()=>{class t{constructor(){this.artworkDomainService=f(B),this.artworkInfraService=f(O),this.nfts=M([]),this.displayIndex=_(0),this.previewImage=_("none"),this.isFullScreen=_(!1),this.displayIndexOutput=W({alias:"displayIndex"}),this.hovering=!1,this.displayArrows=!1,this.displayExpand=!1,this.isImgVisible=!1,R(()=>{let e=this.nfts(),i=this.displayIndex(),n=this.isFullScreen();this.artworkInfraService.getAvailableOptimalUrl(e[i]).subscribe(s=>{this.previewImage.set(n?"none":`url(${s})`)})})}ngOnInit(){this.displayIndex.set(this.artworkDomainService.getLatestVersionIndex(this.nfts()))}ngOnChanges(e){this.displayArrows=e.nfts.currentValue.length>1,this.isImgVisible=!1,this.displayIndexOutput.emit(this.artworkDomainService.getLatestVersionIndex(this.nfts())),this.displayIndex.set(this.artworkDomainService.getLatestVersionIndex(this.nfts()))}setHover(e){this.hovering=e}nextNft(e){this.isImgVisible=!1;let i=(this.displayIndex()+e+this.nfts().length)%this.nfts().length;this.displayIndexOutput.emit(i),this.displayIndex.set(i)}imageLoad(){this.isImgVisible=!0}getQualityImg(e){return this.artworkDomainService.getNftQualityUrl(e?.image)}handleImageClick(){this.displayExpand?this.enterFullScreen():this.isFullScreen()?this.exitFullScreen():(this.displayExpand=!0,setTimeout(()=>{this.displayExpand=!1},2e3))}handleDoubleClick(){this.isFullScreen()||this.enterFullScreen()}enterFullScreen(){this.isFullScreen.set(!0);let e=this.imageElement.nativeElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}exitFullScreen(){this.isFullScreen.set(!1),document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-image-viewer"]],viewQuery:function(i,n){if(i&1&&K(Oe,5),i&2){let s;X(s=Z())&&(n.imageElement=s.first)}},inputs:{nfts:[1,"nfts"]},outputs:{displayIndexOutput:"displayIndex"},features:[$],decls:7,vars:6,consts:[["imageElement",""],[1,"image-viewer",3,"mouseover","mouseleave"],[1,"overlay","left"],[1,"image-container",3,"click","dblclick"],[1,"art-viewer",3,"load","src"],[1,"fullscreen-icon"],[1,"overlay","right"],[1,"overlay","left",3,"click"],[1,"arrow"],[1,"overlay","right",3,"click"]],template:function(i,n){if(i&1){let s=x();r(0,"div",1),p("mouseover",function(){return g(s),h(n.setHover(!0))})("mouseleave",function(){return g(s),h(n.setHover(!1))}),m(1,De,3,0,"div",2),r(2,"div",3),p("click",function(){return g(s),h(n.handleImageClick())})("dblclick",function(){return g(s),h(n.handleDoubleClick())}),r(3,"img",4,0),p("load",function(){return g(s),h(n.imageLoad())}),a(),m(5,Fe,2,0,"mat-icon",5),a(),m(6,Ae,3,0,"div",6),a()}i&2&&(o(),d(n.displayArrows&&n.hovering?1:-1),o(2),J("background-image",n.previewImage()),c("src",n.getQualityImg(n.nfts()[n.displayIndex()]),A),o(2),d(n.displayExpand?5:-1),o(),d(n.displayArrows&&n.hovering?6:-1))},dependencies:[E],styles:[".image-viewer[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.image-viewer[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{max-width:100%;max-height:100%;background-repeat:no-repeat;background-size:100% 100%;cursor:pointer}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:20%;background-color:#ffffff1a;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1;transition:background-color .3s}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]:hover{background-color:#fff6}.image-viewer[_ngcontent-%COMP%]   .overlay.left[_ngcontent-%COMP%]{left:0}.image-viewer[_ngcontent-%COMP%]   .overlay.right[_ngcontent-%COMP%]{right:0}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:#fff;opacity:.8;transition:transform .3s,opacity .3s}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]:hover{transform:scale(1.2);opacity:1}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;background-color:#d3d3d3}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .fullscreen-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;z-index:2;display:none;align-items:center;justify-content:center;pointer-events:none}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]:hover   .fullscreen-icon[_ngcontent-%COMP%]{display:flex}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]{background-color:#000;display:flex;align-items:center;justify-content:center;z-index:3}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{background-color:#000;max-width:100vw;max-height:100vh}"]})}}return t})();function Le(t,u){if(t&1&&(r(0,"mat-list-item")(1,"a",5),l(2),a()()),t&2){let e=u.$implicit;o(),c("href",e,A),o(),L(" ",e.replace("https://","").replace("http://","").replace("www.","")," ")}}var Se=(()=>{class t{constructor(e,i){this.data=e,this.dialogRef=i}close(){this.dialogRef.close()}static{this.\u0275fac=function(i){return new(i||t)(N(_e),N(ve))}}static{this.\u0275cmp=w({type:t,selectors:[["app-links-modal"]],decls:9,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-line","","target","_blank","rel","noopener noreferrer",3,"href"]],template:function(i,n){i&1&&(r(0,"h1",0),l(1),C(2,"translate"),a(),r(3,"div",1)(4,"mat-list"),m(5,Le,3,2,"mat-list-item",2),a()(),r(6,"div",3)(7,"button",4),p("click",function(){return n.close()}),l(8,"Close"),a()()),i&2&&(o(),y(I(2,2,"links.view")),o(4),c("ngForOf",n.data.links))},dependencies:[Ce,Ie,me,ne,pe,se,ke,de,T],encapsulation:2})}}return t})();function Re(t,u){if(t&1){let e=x();r(0,"button",1),C(1,"translate"),p("click",function(){g(e);let n=v();return h(n.openLinksModal())}),r(2,"mat-icon"),l(3,"link"),a()()}t&2&&S("matTooltip",I(1,1,"links.view"))}var be=(()=>{class t{constructor(){this.artworkInfraService=f(O),this.dialog=f(we),this.tokenId=M(),this.haveLinks=_(!1),this.rxUrls=ue({request:()=>this.tokenId(),loader:({request:e})=>this.artworkInfraService.getLinks(e).pipe(Q(),F(i=>i||[]),H(()=>q([])))}),R(()=>{let i=this.rxUrls.value()?.urls;this.haveLinks.set(Array.isArray(i)&&i.length>0)})}openLinksModal(){let e=this.rxUrls.value();this.dialog.open(Se,{data:{links:e?.urls}})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-links-button"]],inputs:{tokenId:[1,"tokenId"]},decls:1,vars:1,consts:[["mat-icon-button","","matTooltipPosition","below",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","below",3,"click","matTooltip"]],template:function(i,n){i&1&&m(0,Re,4,3,"button",0),i&2&&d(n.haveLinks()?0:-1)},dependencies:[U,P,E,T],encapsulation:2})}}return t})();var Be=()=>["/artworks"],Ue=t=>({years:t}),je=t=>[t];function Ne(t,u){t&1&&(k(0,"span",9),C(1,"translate")),t&2&&S("matTooltip",I(1,1,"sold"))}function Ye(t,u){if(t&1&&k(0,"app-pdf-button",11),t&2){let e=v(2);c("nfts",Y(1,je,e.frontalViewNft()))}}function ze(t,u){if(t&1&&(r(0,"mat-grid-tile",4)(1,"div",7)(2,"h3")(3,"i"),l(4),r(5,"small"),l(6),a()()(),r(7,"h3")(8,"small")(9,"a",8),l(10),a(),l(11),C(12,"translate"),m(13,Ne,2,3,"span",9),a()(),r(14,"small"),k(15,"app-download-button",10),m(16,Ye,1,3,"app-pdf-button",11),k(17,"app-links-button",12),a()()()),t&2){let e=v();c("colspan",e.horizontalView?1:3),o(4),L("",e.nft().name,". "),o(2),y(e.getViewLabel(e.nft())),o(3),c("routerLink",ie(17,Be))("queryParams",Y(18,Ue,e.getTraitValue(e.nft(),e.validTraits.YEAR))),o(),y(e.getTraitValue(e.nft(),e.validTraits.YEAR)),o(),te(", ",I(12,15,e.getTraitValue(e.nft(),e.validTraits.MEDIUM)),", ",e.getTraitValue(e.nft(),e.validTraits.HEIGHT)," x ",e.getTraitValue(e.nft(),e.validTraits.WIDTH)," ",e.getTraitValue(e.nft(),e.validTraits.UNIT),". "),o(2),d(e.sold(e.nft().tokenId)?13:-1),o(2),c("link",e.getQualityImg(e.nft().image))("name",e.nft().name),o(),d(e.frontalViewNft()?16:-1),o(),c("tokenId",e.nft().tokenId)}}function qe(t,u){if(t&1&&(r(0,"div",5)(1,"h3"),l(2),a(),r(3,"p"),l(4),a(),r(5,"h3"),l(6),a()()),t&2){let e=v();o(2),y(e.getTraitValue(e.nft(),e.validTraits.PROJECT)),o(2),y(e.nft().description),o(2),y(e.getTraitValue(e.nft(),e.validTraits.DESC_AUTHOR))}}function He(t,u){if(t&1){let e=x();r(0,"div",6),k(1,"mat-divider"),r(2,"h3"),l(3),C(4,"translate"),a(),r(5,"app-art-pieces-list",13),p("selectedTokenId",function(n){g(e);let s=v();return h(s.handleSelectedItem(n))}),a()()}if(t&2){let e=v();o(3),ee(" ",I(4,5,"moreOn")," ",e.getTraitValue(e.nft(),e.validTraits.YEAR)," "),o(2),c("viewAsWidget",!0)("numberOfCols",e.numberOfViewMoreColumns)("nftFilters",e.getSameYearListFilter(e.nft()))}}var qt=(()=>{class t{constructor(){this.router=f(ae),this.activatedroute=f(re),this.artworkDomainService=f(B),this.artworkInfraService=f(O),this.responsiveService=f(ye),this.validTraits=D,this.displayingIndex=_(0),this.nfts=_([]),this.nft=z(()=>this.nfts()[this.displayingIndex()]),this.frontalViewNft=_(void 0),this.thereAreMoreInYear=z(()=>{let e=this.artworkDomainService.getTraitValue(this.nft(),D.YEAR);return this.artworkInfraService.getNftLenghtByYear(e)>1}),this.numberOfViewMoreColumns=3,this.horizontalView=!1,this.latestVersionIndex=0,this.responsiveService.displayMobileLayout.subscribe(e=>{this.horizontalView=e,this.numberOfViewMoreColumns=e?6:3})}ngOnInit(){this.listenIdParamChange()}listenIdParamChange(){this.activatedroute.paramMap.pipe(F(e=>e.get("id")),G(e=>this.artworkInfraService.getSameArtThanObservable(e))).subscribe(e=>{this.nfts.set(e),this.latestVersionIndex=this.artworkDomainService.getLatestVersionIndex(this.nfts()),this.displayingIndex.set(this.latestVersionIndex),this.setFrontalView(e)})}getViewLabel(e){switch(this.getTraitValue(e,this.validTraits.IMAGETYPE)){case b.PROGRESS:return`(${b.PROGRESS})`;case b.DETAIL:return`(${b.DETAIL})`;default:return this.displayingIndex()===this.latestVersionIndex?"":`(${b.PROGRESS})`}}generateRatio(e){let i=parseFloat(this.getTraitValue(e,D.HEIGHT)),n=parseFloat(this.getTraitValue(e,D.WIDTH)),s=this.horizontalView?0:Math.ceil(i/n);return Math.ceil(i/n*2)+s}getSameYearListFilter(e){let i=this.nfts().map(s=>s.tokenId);return{years:[this.getTraitValue(e,this.validTraits.YEAR)],idsToExclude:i}}getTraitValue(e,i){return this.artworkDomainService.getTraitValue(e,i)}sold(e){return oe.includes(e)}getQualityImg(e){return this.artworkDomainService.getNftQualityUrl(e)}indexChanged(e){this.displayingIndex.set(e)}setFrontalView(e){let i=e.find(n=>this.artworkDomainService.isFrontalView(n,e));this.frontalViewNft.set(i)}handleSelectedItem(e){this.router.navigate(["/art",e])}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-art-piece"]],decls:7,vars:6,consts:[[1,"container","margin-top"],["cols","3"],[1,"viewer-container",3,"colspan","rowspan"],[1,"fit-width",3,"displayIndex","nfts"],["rowspan","2",3,"colspan"],[1,"art-piece-desc"],[1,"margin-top"],[1,"art-piece-labels"],[3,"routerLink","queryParams"],[1,"dot",3,"matTooltip"],[3,"link","name"],[3,"nfts"],[3,"tokenId"],[3,"selectedTokenId","viewAsWidget","numberOfCols","nftFilters"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"mat-grid-list",1)(2,"mat-grid-tile",2)(3,"app-image-viewer",3),p("displayIndex",function(V){return n.indexChanged(V)}),a()(),m(4,ze,18,20,"mat-grid-tile",4),a(),m(5,qe,7,3,"div",5)(6,He,6,7,"div",6),a()),i&2&&(o(2),c("colspan",n.horizontalView?2:3)("rowspan",n.generateRatio(n.nft())),o(),c("nfts",n.nfts()),o(),d(n.nft()?4:-1),o(),d(n.nft().description?5:-1),o(),d(n.thereAreMoreInYear()?6:-1))},dependencies:[ge,fe,Me,le,P,Ve,xe,be,ce,Te,T],styles:[".dot[_ngcontent-%COMP%]{height:1rem;width:1rem;background-color:#cf2525;border-radius:50%;display:inline-block;margin-left:.8rem;vertical-align:middle}.art-piece-labels[_ngcontent-%COMP%]{padding:10%;text-align:center;width:100%}.art-piece-desc[_ngcontent-%COMP%]{white-space:pre-line}.viewer-container[_ngcontent-%COMP%]{height:100%}"]})}}return t})();export{qt as ArtPieceComponent};
