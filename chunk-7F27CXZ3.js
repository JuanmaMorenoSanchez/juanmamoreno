import{b as Y,d as q,j as Z,k as J,l as g}from"./chunk-UUJUUSO5.js";import{b as L,d as at}from"./chunk-EKHLUWSP.js";import{a as ot,b as ct,l as dt}from"./chunk-O7JLKHVY.js";import{a as rt,b as nt}from"./chunk-ZODY27AD.js";import{h as tt,i as et,k as it,n as f}from"./chunk-BEVEE7IB.js";import{e as K}from"./chunk-BKOE4B3O.js";import{h as X}from"./chunk-6YHBLYQ2.js";import{Aa as B,Ba as b,Ca as N,Cc as D,Db as M,Ea as C,Eb as p,F as V,Gb as $,Jb as U,Kb as u,Mb as k,Nb as T,Ob as o,Pb as s,Qb as P,Sb as F,Ub as w,Vb as c,Wb as G,Xb as W,ab as R,ba as z,cb as n,dc as S,ea as m,ec as H,fc as O,ma as h,na as v,nc as Q,ob as x,oc as I,pc as A,q as E,qb as _,ub as y,xa as j}from"./chunk-T7XUK2UF.js";var ut=["*"];var gt=new z("MAT_CARD_CONFIG"),mt=(()=>{class i{appearance;constructor(){let t=m(gt,{optional:!0});this.appearance=t?.appearance||"raised"}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=x({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(e,a){e&2&&$("mat-mdc-card-outlined",a.appearance==="outlined")("mdc-card--outlined",a.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:ut,decls:1,vars:0,template:function(e,a){e&1&&(G(),W(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return i})();var lt=(()=>{class i{static \u0275fac=function(e){return new(e||i)};static \u0275dir=_({type:i,selectors:[["","mat-card-image",""],["","matCardImage",""]],hostAttrs:[1,"mat-mdc-card-image","mdc-card__media"]})}return i})();var pt=(()=>{class i{constructor(){this.el=m(N),this.visible=new j,this.observer=new IntersectionObserver(t=>{t.forEach(e=>{e.isIntersecting&&(this.visible.emit(),this.observer.unobserve(this.el.nativeElement))})},{threshold:.1})}ngOnInit(){this.observer.observe(this.el.nativeElement)}ngOnDestroy(){this.observer.disconnect()}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275dir=_({type:i,selectors:[["","appLazyLoad",""]],outputs:{visible:"visible"}})}}return i})();var ft=i=>({container:i});function ht(i,d){return this.methodTracking(d)}function vt(i,d){if(i&1&&(o(0,"mat-icon"),S(1),s()),i&2){let t=c(3);n(),O(" ",t.sortOrder()==="asc"?"arrow_upward":"arrow_downward"," ")}}function Ct(i,d){if(i&1){let t=F();o(0,"mat-chip",6),I(1,"translate"),I(2,"translate"),w("click",function(){let a=h(t).$implicit,r=c(2);return v(r.changeSortMethod(a))}),o(3,"mat-icon"),S(4),s(),y(5,vt,2,1,"mat-icon"),s()}if(i&2){let t=d.$implicit,e=c(2);p("matTooltip",`${A(1,4,"sortBy")} ${t}`),M("aria-label",`${A(2,6,"sortBy")} ${t}`),n(4),O(" ",t==="year"?"calendar_today":t==="medium"?"palette":"crop_free"," "),n(),u(e.activeSortMethod()===t?5:-1)}}function yt(i,d){if(i&1&&(o(0,"mat-chip",5),I(1,"translate"),P(2,"app-pdf-button",7),s()),i&2){let t=c(2);M("aria-label",A(1,2,"download.portfolio")),n(2),p("nfts",t.selectedNfts())}}function bt(i,d){if(i&1&&(o(0,"div",1)(1,"mat-chip-listbox"),k(2,Ct,6,8,"mat-chip",4,ht,!0),y(4,yt,3,4,"mat-chip",5),s()()),i&2){let t=c();n(2),T(t.sortMethods),n(2),u(t.selectedNfts().length?4:-1)}}function xt(i,d){if(i&1&&(o(0,"div",10)(1,"span",12),S(2),s()()),i&2){let t=c().$implicit,e=c(2);n(2),H(e.getOrderNumber(t))}}function _t(i,d){if(i&1){let t=F();o(0,"mat-grid-tile",9),w("contextmenu",function(a){let r=h(t).$implicit,l=c(2);return v(l.toggleNftSelection(a,r))})("click",function(){let a=h(t).$implicit,r=c(2);return v(r.handleArtPieceClick(a.tokenId))}),o(1,"mat-card"),y(2,xt,3,1,"div",10),o(3,"img",11),w("visible",function(){let a=h(t).$implicit,r=c(2);return v(r.onImageVisible(a.tokenId))}),s()()()}if(i&2){let t,e=d.$implicit,a=c(2);M("aria-label",e.name),n(2),u(a.isSelected(e)?2:-1),n(),p("src",a.displayedImages.has(e.tokenId)&&(t=a.imgThumbUrls().get(e.tokenId))!==null&&t!==void 0?t:null,R)("alt","Artwork "+e.name)}}function Mt(i,d){if(i&1&&(o(0,"mat-grid-list",2),k(1,_t,4,4,"mat-grid-tile",8,U().listTracking,!0),s()),i&2){let t=c();p("cols",t.numberOfCols()),n(),T(t.visibleArtPieces())}}function wt(i,d){i&1&&P(0,"mat-progress-spinner",3)}var ne=(()=>{class i{constructor(){this.artworkService=m(et),this.router=m(q),this.activatedroute=m(Y),this.responsiveService=m(at),this.sessionQuery=m(it),this.numberOfCols=b(this.responsiveService.displayMobileLayout.value?3:2),this.viewAsWidget=b(!1),this.selectedTokenId=B(),this.sortMethods=Object.values(f),this.yearParamSignal=L(this.activatedroute.queryParamMap.pipe(E(t=>{let e=t.get("years");return e?e.split(","):[]})),{initialValue:[]}),this.nftFilters=b({}),this.artPieces=L(this.artworkService.getArtPiecesObservable()),this.dataReady=D(()=>!!this.artPieces()?.length),this.activeSortMethod=C(f.YEAR),this.sortOrder=C(g.DESC),this.sortedArtPieces=D(()=>{switch(this.activeSortMethod()){case f.SIZE:return this.artworkService.sortBySize(this.artPieces(),this.sortOrder());case f.MEDIUM:return this.artworkService.sortByMedium(this.artPieces(),this.sortOrder());case f.YEAR:return this.artworkService.sortByYear(this.artPieces(),this.sortOrder())}}),this.visibleArtPieces=D(()=>{let t=this.sortedArtPieces(),e=this.yearParamSignal(),a=this.nftFilters()?.years;return(t??[]).filter(r=>!this.artworkService.isExcludedByYear(r,a?.length?a:e)&&!this.isExcludedById(r)&&this.isMemoizedFrontalView(r))}),this.displayedImages=new Set,this.imgThumbUrls=C(new Map),this.selectedNfts=C([]),this.frontalViewMap=new Map}onImageVisible(t){this.displayedImages.add(t);let e=this.artPieces()?.find(a=>a.tokenId===t);e&&this.loadImgThumbUrl(e)}loadImgThumbUrl(t){this.imgThumbUrls().has(t.tokenId)||this.artworkService.getAvailableOptimalUrl(t).pipe(V(1)).subscribe(e=>{this.imgThumbUrls.update(a=>{let r=new Map(a);return r.set(t.tokenId,e),r})})}toggleNftSelection(t,e){t.preventDefault();let a=this.selectedNfts(),r=a.findIndex(l=>l.tokenId===e.tokenId);if(r===-1)this.selectedNfts.set([...a,e]);else{let l=[...a];l.splice(r,1),this.selectedNfts.set(l)}}isSelected(t){return this.selectedNfts().some(e=>e.tokenId===t.tokenId)}getOrderNumber(t){let e=this.selectedNfts().findIndex(a=>a.tokenId===t.tokenId);return e!==-1?e+1:null}toggleSortOrder(){this.sortOrder.set(this.sortOrder()===g.ASC?g.DESC:g.ASC)}changeSortMethod(t){this.activeSortMethod()===t?this.toggleSortOrder():(this.activeSortMethod.set(t),this.sortOrder.set(g.ASC))}handleArtPieceClick(t){this.selectedTokenId.emit(t),this.router.navigate(["/artwork",t])}listTracking(t,e){return e}methodTracking(t){return t}isMemoizedFrontalView(t){if(this.frontalViewMap.has(t.tokenId))return this.frontalViewMap.get(t.tokenId)||!1;{let e=this.artworkService.getArtByTitle(t.name,this.sessionQuery.selectArtPieces),a=this.artworkService.isFrontalView(t,e);return this.frontalViewMap.set(t.tokenId,a),a}}isExcludedById(t){return this.nftFilters()?.idsToExclude?.length?this.nftFilters().idsToExclude.includes(t.tokenId):!1}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=x({type:i,selectors:[["app-art-pieces-list"]],inputs:{numberOfCols:[1,"numberOfCols"],viewAsWidget:[1,"viewAsWidget"],nftFilters:[1,"nftFilters"]},outputs:{selectedTokenId:"selectedTokenId"},decls:4,vars:5,consts:[[3,"ngClass"],[1,"sort-group"],["gutterSize","10","rowHeight","1:1","role","list","aria-label","Art Pieces",3,"cols"],["diameter","48","mode","indeterminate","aria-label","Loading art pieces"],["color","primary","role","button",3,"matTooltip"],["role","button"],["color","primary","role","button",3,"click","matTooltip"],[3,"nfts"],["role","listitem"],["role","listitem",3,"contextmenu","click"],[1,"overlay"],["mat-card-image","","loading","lazy","appLazyLoad","",1,"front-image",3,"visible","src","alt"],[1,"order-number"]],template:function(e,a){e&1&&(o(0,"div",0),y(1,bt,5,1,"div",1)(2,Mt,3,1,"mat-grid-list",2)(3,wt,1,0,"mat-progress-spinner",3),s()),e&2&&(p("ngClass",Q(3,ft,!a.viewAsWidget())),n(),u(a.viewAsWidget()?-1:1),n(),u(a.dataReady()?2:3))},dependencies:[X,J,Z,tt,ct,dt,nt,rt,mt,ot,lt,pt,K],styles:["mat-grid-tile[_ngcontent-%COMP%]{cursor:pointer}mat-card[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;display:flex;align-items:stretch;justify-content:stretch}.container[_ngcontent-%COMP%]{margin-top:0}.sort-group[_ngcontent-%COMP%]{margin-bottom:2em}.sort-desc[_ngcontent-%COMP%]{margin-left:2em;align-items:center;display:flex}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5em;z-index:1;pointer-events:none}.order-number[_ngcontent-%COMP%]{font-weight:700}"]})}}return i})();export{ne as a};
