import{a as ke,b as ye}from"./chunk-O6ZQLPF4.js";import{a as Ee}from"./chunk-BUWLJQHN.js";import{b as de,d as U,e as ue}from"./chunk-MDN2ABPD.js";import{b as z,c as ve,d as _e}from"./chunk-EDL2K6OT.js";import{a as Ce}from"./chunk-P42B2O63.js";import{a as Ie,b as L,c as be,d as Te,e as xe,f as Me,g as Se,h as Pe,l as Ve}from"./chunk-MPKX63LD.js";import"./chunk-WMOO2DM3.js";import"./chunk-66USBEYI.js";import{h as E,i as O,l as j,m as Y,o as we}from"./chunk-5455S3W3.js";import{Fa as he,Ha as F,aa as ge,d as fe,e as b}from"./chunk-EZOMQRJD.js";import{f as pe,i as me}from"./chunk-FD77GF5O.js";import{$b as te,B as G,Ba as M,Ea as v,Eb as y,Ec as w,Fb as c,Fc as V,Gb as Z,Hb as N,I as K,Lb as _,Pb as o,Qb as a,Rb as x,T as $,Tb as S,Vb as d,Wb as I,Zb as ee,ab as q,ac as ie,bc as ne,cb as r,ea as m,fc as l,gc as D,hb as W,hc as A,ic as oe,jc as re,kc as ae,lb as J,lc as se,m as Q,ma as g,mc as le,na as h,oc as ce,pb as C,pc as H,q as B,qc as s,rc as p,sb as X,sc as P,vb as f}from"./chunk-D2Y6Y2E3.js";import"./chunk-FK6H3RFT.js";import"./chunk-4X36HX5K.js";var Oe=(()=>{class i{constructor(){this.router=m(U),this.location=m(pe)}navigateBack(){window.history.length>1?this.location.back():this.router.navigate(["/"])}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["app-back-button"]],decls:5,vars:6,consts:[["mat-icon-button","","matTooltipPosition","right",1,"back-button",3,"click","matTooltip"]],template:function(t,n){t&1&&(o(0,"button",0),s(1,"translate"),s(2,"translate"),d("click",function(){return n.navigateBack()}),o(3,"mat-icon"),l(4,"keyboard_double_arrow_left"),a()()),t&2&&(ee("matTooltip",p(1,2,"back")),y("aria-label",p(2,4,"back")))},dependencies:[F,E,L,b],styles:[".back-button[_ngcontent-%COMP%]{margin-bottom:1em}"]})}}return i})();function Ae(i,k){i&1&&(o(0,"mat-icon"),l(1,"download"),a())}function qe(i,k){i&1&&x(0,"mat-progress-spinner",1)}var Le=(()=>{class i{constructor(){this.link=M(),this.name=M(),this.isDownloading=!1}downloadImage(){this.isDownloading=!0,fetch(this.link()).then(e=>{if(!e.ok)throw new Error("Failed to fetch the image.");return e.blob()}).then(e=>{let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`${this.name()}.jpg`,n.click(),URL.revokeObjectURL(t)}).catch(e=>{console.error("Error downloading the image:",e)}).finally(()=>{this.isDownloading=!1})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["app-download-button"]],inputs:{link:[1,"link"],name:[1,"name"]},decls:5,vars:8,consts:[["mat-icon-button","","matTooltipPosition","below",3,"click","disabled","matTooltip"],["diameter","24","mode","indeterminate"]],template:function(t,n){t&1&&(o(0,"button",0),s(1,"translate"),s(2,"translate"),d("click",function(){return n.downloadImage()}),f(3,Ae,2,0,"mat-icon")(4,qe,1,0,"mat-progress-spinner",1),a()),t&2&&(c("disabled",n.isDownloading)("matTooltip",p(1,4,"download.hd")),y("aria-label",p(2,6,"download.hd")),r(3),_(n.isDownloading?4:3))},dependencies:[F,L,E,Ie,b],encapsulation:2})}}return i})();var Ne=["imageElement"];function Ue(i,k){if(i&1){let e=S();o(0,"div",7),d("click",function(){g(e);let n=I();return h(n.nextNft(-1))}),o(1,"mat-icon",8),l(2," arrow_back "),a()()}}function je(i,k){i&1&&(o(0,"mat-icon",5),l(1," fullscreen "),a())}function Ye(i,k){if(i&1){let e=S();o(0,"div",9),d("click",function(){g(e);let n=I();return h(n.nextNft(1))}),o(1,"mat-icon",8),l(2," arrow_forward "),a()()}}var Fe=(()=>{class i{constructor(){this.artworkService=m(O),this.nfts=M([]),this.description=M("No description"),this.displayIndex=J(0),this.previewImage=v("none"),this.qualityImage=v("none"),this.isFullScreen=v(!1),this.hiResLoaded=v(!1),this.displayArrows=w(()=>this.nfts().length>1),this.isImgVisible=v(!0),this.hovering=!1,this.displayExpand=!1,V(()=>{this.loadCurrentImage()})}setHover(e){this.hovering=e}nextNft(e){let t=(this.displayIndex()+e+this.nfts().length)%this.nfts().length;this.displayIndex.set(t)}handleImageClick(){this.displayExpand?this.enterFullScreen():this.isFullScreen()?this.exitFullScreen():(this.displayExpand=!0,setTimeout(()=>{this.displayExpand=!1},2e3))}handleDoubleClick(){this.isFullScreen()||this.enterFullScreen()}onHiResLoad(){this.hiResLoaded.set(!0)}onHiResLoadError(){this.displayIndex.set(0),this.hiResLoaded.set(!0)}loadCurrentImage(){let e=this.nfts()[this.displayIndex()];if(!e&&this.nfts().length>0){this.displayIndex.set(0);return}if(!e)return;this.previewImage.set("none"),this.qualityImage.set("none"),this.hiResLoaded.set(!1),this.isFullScreen()||this.artworkService.getAvailableOptimalUrl(e).subscribe(n=>this.previewImage.set(`url(${n})`));let t=this.artworkService.getNftQualityUrl(e.image);this.qualityImage.set(t||"none")}enterFullScreen(){this.isFullScreen.set(!0);let e=this.imageElement.nativeElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}exitFullScreen(){this.isFullScreen.set(!1),document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["app-image-viewer"]],viewQuery:function(t,n){if(t&1&&te(Ne,5),t&2){let u;ie(u=ne())&&(n.imageElement=u.first)}},inputs:{nfts:[1,"nfts"],description:[1,"description"],displayIndex:[1,"displayIndex"]},outputs:{displayIndex:"displayIndexChange"},decls:7,vars:10,consts:[["imageElement",""],[1,"image-viewer",3,"mouseover","mouseleave"],[1,"overlay","left"],[1,"image-container",3,"click","dblclick"],[1,"art-viewer","blur",3,"load","error","src"],[1,"fullscreen-icon"],[1,"overlay","right"],[1,"overlay","left",3,"click"],[1,"arrow"],[1,"overlay","right",3,"click"]],template:function(t,n){if(t&1){let u=S();o(0,"div",1),d("mouseover",function(){return g(u),h(n.setHover(!0))})("mouseleave",function(){return g(u),h(n.setHover(!1))}),f(1,Ue,3,0,"div",2),o(2,"div",3),d("click",function(){return g(u),h(n.handleImageClick())})("dblclick",function(){return g(u),h(n.handleDoubleClick())}),o(3,"img",4,0),d("load",function(){return g(u),h(n.onHiResLoad())})("error",function(){return g(u),h(n.onHiResLoadError())}),a(),f(5,je,2,0,"mat-icon",5),a(),f(6,Ye,3,0,"div",6),a()}t&2&&(r(),_(n.displayArrows()&&n.hovering?1:-1),r(2),Z("background-image",n.previewImage()),N("loaded",n.hiResLoaded()),c("src",n.qualityImage(),q),y("alt",n.description())("data-key",n.isFullScreen()?null:n.displayIndex()),r(2),_(n.displayExpand?5:-1),r(),_(n.displayArrows()&&n.hovering?6:-1))},dependencies:[E],styles:[".image-viewer[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.image-viewer[_ngcontent-%COMP%]   .blur[_ngcontent-%COMP%]{filter:blur(10px);transform:scale(1.01)}.image-viewer[_ngcontent-%COMP%]   .loaded[_ngcontent-%COMP%]{filter:none!important;transform:none!important}.image-viewer[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{max-width:100%;max-height:100%;background-repeat:no-repeat;background-size:100% 100%;cursor:pointer}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:20%;background-color:#ffffff1a;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]:hover{background-color:#fff6}.image-viewer[_ngcontent-%COMP%]   .overlay.left[_ngcontent-%COMP%]{left:0}.image-viewer[_ngcontent-%COMP%]   .overlay.right[_ngcontent-%COMP%]{right:0}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:#fff;opacity:.8}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]:hover{transform:scale(1.2);opacity:1}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .fullscreen-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;z-index:2;display:none;align-items:center;justify-content:center;pointer-events:none}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]:hover   .fullscreen-icon[_ngcontent-%COMP%]{display:flex}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]{background-color:#000;display:flex;align-items:center;justify-content:center;z-index:3}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{background-color:#000;max-width:100vw;max-height:100vh}"]})}}return i})();function We(i,k){if(i&1&&(o(0,"mat-list-item")(1,"a",5),l(2),a()()),i&2){let e=k.$implicit;r(),c("href",e,q),r(),A(" ",e.replace("https://","").replace("http://","").replace("www.","")," ")}}var Re=(()=>{class i{constructor(e,t){this.data=e,this.dialogRef=t}close(){this.dialogRef.close()}static{this.\u0275fac=function(t){return new(t||i)(W(Te),W(be))}}static{this.\u0275cmp=C({type:i,selectors:[["app-links-modal"]],decls:11,vars:10,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-line","","target","_blank","rel","noopener noreferrer",3,"href"]],template:function(t,n){t&1&&(o(0,"h2",0),l(1),s(2,"translate"),a(),o(3,"div",1)(4,"mat-list"),f(5,We,3,2,"mat-list-item",2),a()(),o(6,"div",3)(7,"button",4),s(8,"translate"),d("click",function(){return n.close()}),l(9),s(10,"translate"),a()()),t&2&&(r(),D(p(2,4,"links.view")),r(4),c("ngForOf",n.data.links),r(2),y("aria-label",p(8,6,"close")),r(2),A(" ",p(10,8,"close")," "))},dependencies:[Me,Se,ke,me,ye,ge,Pe,he,b],encapsulation:2})}}return i})();function He(i,k){if(i&1){let e=S();o(0,"button",1),s(1,"translate"),s(2,"translate"),d("click",function(){g(e);let n=I();return h(n.openLinksModal())}),o(3,"mat-icon"),l(4,"link"),a()()}i&2&&(c("matTooltip",p(1,2,"links.view")),y("aria-label",p(2,4,"links.view")))}var Be=(()=>{class i{constructor(){this.artworkService=m(O),this.dialog=m(xe),this.tokenId=M(),this.haveLinks=v(!1),this.rxUrls=ve({request:()=>this.tokenId(),loader:({request:e})=>this.artworkService.getLinks(e).pipe(K(),B(t=>t||[]),G(()=>Q([])))}),V(()=>{let t=this.rxUrls.value()?.urls;this.haveLinks.set(Array.isArray(t)&&t.length>0)})}openLinksModal(){let e=this.rxUrls.value();this.dialog.open(Re,{data:{links:e?.urls}})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["app-links-button"]],inputs:{tokenId:[1,"tokenId"]},decls:1,vars:1,consts:[["mat-icon-button","","matTooltipPosition","below",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","below",3,"click","matTooltip"]],template:function(t,n){t&1&&f(0,He,5,6,"button",0),t&2&&_(n.haveLinks()?0:-1)},dependencies:[F,L,E,b],encapsulation:2})}}return i})();var De=(()=>{class i{constructor(){this.artworkService=m(O)}transform(e,t){return e?this.artworkService.getTraitValue(e,t):""}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=X({name:"trait",type:i,pure:!0})}}return i})();var ze=()=>["/artworks"],Qe=i=>({years:i}),Ge=i=>[i];function Ke(i,k){i&1&&(x(0,"span",5),s(1,"translate")),i&2&&c("matTooltip",p(1,1,"sold"))}function $e(i,k){if(i&1&&x(0,"app-pdf-button",7),i&2){let e=I(2);c("nfts",H(1,Ge,e.frontalViewNft()))}}function Je(i,k){if(i&1&&(o(0,"div",3)(1,"h2")(2,"i"),l(3),o(4,"small"),l(5),a()()(),o(6,"h3")(7,"small")(8,"a",4),s(9,"trait"),l(10),s(11,"trait"),a(),l(12),s(13,"trait"),s(14,"translate"),s(15,"trait"),s(16,"trait"),s(17,"trait"),f(18,Ke,2,3,"span",5),a()(),o(19,"small"),x(20,"app-download-button",6),f(21,$e,1,3,"app-pdf-button",7),x(22,"app-links-button",8),a()()),i&2){let e=I();r(3),A("",e.nft().name,". "),r(2),D(e.viewLabel()),r(3),c("routerLink",ce(34,ze))("queryParams",H(35,Qe,P(9,14,e.nft(),e.validTraits.YEAR))),r(2),D(P(11,17,e.nft(),e.validTraits.YEAR)),r(2),re(", ",p(14,23,P(13,20,e.nft(),e.validTraits.MEDIUM)),", ",P(15,25,e.nft(),e.validTraits.HEIGHT)," x ",P(16,28,e.nft(),e.validTraits.WIDTH)," ",P(17,31,e.nft(),e.validTraits.UNIT),". "),r(6),_(e.sold()?18:-1),r(2),c("link",e.qualityImg())("name",e.nft().name),r(),_(e.frontalViewNft()?21:-1),r(),c("tokenId",e.tokenId())}}function Xe(i,k){if(i&1){let e=S();x(0,"mat-divider",9),o(1,"p"),l(2),s(3,"translate"),s(4,"trait"),a(),o(5,"app-art-pieces-list",10),d("selectedTokenId",function(n){g(e);let u=I();return h(u.handleSelectedItem(n))}),a()}if(i&2){let e=I();r(2),oe("",p(3,5,"moreOn")," ",P(4,7,e.nft(),e.validTraits.YEAR),""),r(3),c("viewAsWidget",!0)("numberOfCols",e.numberOfViewMoreColumns())("nftFilters",e.getSameYearListFilter())}}var pi=(()=>{class i{constructor(){this.router=m(U),this.route=m(de),this.artworkService=m(O),this.responsiveService=m(_e),this.translateService=m(fe),this.validTraits=j,this.numberOfViewMoreColumns=z(this.responsiveService.displayMobileLayout.pipe(B(e=>e?6:3)),{initialValue:3}),this.nfts=z(this.route.paramMap.pipe(B(e=>e.get("id")),$(e=>this.artworkService.getSameArtThanObservable(e))),{initialValue:[]}),this.defaultDisplayIndex=w(()=>{let e=this.nfts(),t=this.artworkService.getLatestVersion(this.artworkService.filterFrontalArtworks(e));return e.findIndex(n=>n.tokenId===t?.tokenId)}),this.displayingIndex=v(this.defaultDisplayIndex()||0),this.nft=w(()=>this.nfts()[this.displayingIndex()]),this.tokenId=w(()=>this.nft()?.tokenId),this.currentLang=v(this.translateService.currentLang==="es-ES"?"es":"en"),this.descriptions=v(null),this.description=w(()=>{let e=this.descriptions(),t=this.currentLang();return this.getShortDescription(e,t)}),this.frontalViewNft=w(()=>this.nfts().find(e=>this.artworkService.isFrontalView(e,this.nfts()))),this.thereAreMoreInYear=w(()=>{let e=this.artworkService.getTraitValue(this.nft(),j.YEAR);return this.artworkService.getFullNftLenghtByYear(e)>1}),this.getSameYearListFilter=w(()=>({years:[this.getTraitValue(this.nft(),j.YEAR)],idsToExclude:this.nfts().map(e=>e.tokenId)})),this.viewLabel=w(()=>{let e=this.nft();if(!e)return"";let t=this.getTraitValue(e,this.validTraits.IMAGETYPE);if(t===Y.PROGRESS||t===Y.DETAIL)return`(${t})`;let n=this.artworkService.getLatestVersion(this.artworkService.filterFrontalArtworks(this.nfts()));return this.nft().tokenId===n?.tokenId?"":`(${Y.PROGRESS})`}),this.qualityImg=w(()=>this.artworkService.getNftQualityUrl(this.nft().image)),this.sold=w(()=>we.includes(this.tokenId())),this.isFading=v(!1),this.translateService.onLangChange.subscribe(({lang:e})=>{this.currentLang.set(e==="es-ES"?"es":"en")}),V(()=>{this.displayingIndex.set(this.defaultDisplayIndex()||0)}),V(()=>{let e=this.displayingIndex();this.isFading.set(!0),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>this.isFading.set(!1),300)},150)}),V(()=>{let e=this.tokenId();this.artworkService.getArtPieceDescriptions(e).subscribe(t=>{this.descriptions.set(t)})})}getTraitValue(e,t){return this.artworkService.getTraitValue(e,t)}getShortDescription(e,t){return e&&e.translated.find(n=>n.lang===t)?.shortDesc||"No description available"}handleSelectedItem(e){this.router.navigate(["/art",e])}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=C({type:i,selectors:[["app-art-piece"]],decls:6,vars:7,consts:[[1,"container","margin-top"],[1,"fade-container"],[1,"fit-width",3,"displayIndexChange","nfts","description","displayIndex"],[1,"art-piece-labels"],[3,"routerLink","queryParams"],[1,"dot",3,"matTooltip"],[3,"link","name"],[3,"nfts"],[3,"tokenId"],[1,"separator"],[3,"selectedTokenId","viewAsWidget","numberOfCols","nftFilters"]],template:function(t,n){t&1&&(o(0,"div",0),x(1,"app-back-button"),o(2,"div",1)(3,"app-image-viewer",2),le("displayIndexChange",function(T){return se(n.displayingIndex,T)||(n.displayingIndex=T),T}),a(),f(4,Je,23,37,"div",3),a(),f(5,Xe,6,10),a()),t&2&&(r(2),N("fade-out",n.isFading()),r(),c("nfts",n.nfts())("description",n.description()),ae("displayIndex",n.displayingIndex),r(),_(n.nft()?4:-1),r(),_(n.thereAreMoreInYear()?5:-1))},dependencies:[Fe,ue,L,Le,Ve,Be,Ce,Ee,b,De,Oe],styles:[".dot[_ngcontent-%COMP%]{height:1rem;width:1rem;background-color:#cf2525;border-radius:50%;display:inline-block;margin-left:.8rem;vertical-align:middle}.art-piece-labels[_ngcontent-%COMP%]{padding:8%;text-align:center}.art-piece-desc[_ngcontent-%COMP%]{white-space:pre-line}.separator[_ngcontent-%COMP%]{margin-bottom:1em}"]})}}return i})();export{pi as ArtPieceComponent};
