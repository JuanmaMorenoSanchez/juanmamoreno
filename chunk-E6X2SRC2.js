import{a as rt,b as nt,l as dt}from"./chunk-WOF6USAY.js";import{b as J}from"./chunk-IMHJ4VR2.js";import{a as et,b as it}from"./chunk-VR7XR56O.js";import{a as K,b as tt,c as ct}from"./chunk-BGX23TSS.js";import{a as g,b as X,d as f,f as Q,g as at}from"./chunk-X3EP5WNA.js";import{b as st}from"./chunk-G52JQC2S.js";import{b as q,d as Z}from"./chunk-LASWX45Q.js";import{k as ot}from"./chunk-DEDRS5YO.js";import{k as H,n as W}from"./chunk-CLQEGP7A.js";import{$b as T,Aa as E,Ba as _,Ca as V,Ea as x,Fc as F,Gb as C,I as S,Ib as j,Lb as N,Mb as l,Ob as D,Pb as A,Qb as c,Rb as s,Sb as M,Ub as k,Wb as w,Xb as r,Yb as R,Zb as B,ab as z,ba as L,cb as n,ea as d,hc as I,ic as $,jc as P,ma as h,na as v,ob as y,qb as b,rc as Y,sc as G,tc as U,ub as u,xa as O}from"./chunk-KQGZ6FSG.js";var gt=["*"];var ft=new L("MAT_CARD_CONFIG"),lt=(()=>{class e{appearance;constructor(){let t=d(ft,{optional:!0});this.appearance=t?.appearance||"raised"}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=y({type:e,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(i,a){i&2&&j("mat-mdc-card-outlined",a.appearance==="outlined")("mdc-card--outlined",a.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:gt,decls:1,vars:0,template:function(i,a){i&1&&(R(),B(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return e})();var pt=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275dir=b({type:e,selectors:[["","mat-card-image",""],["","matCardImage",""]],hostAttrs:[1,"mat-mdc-card-image","mdc-card__media"]})}return e})();var ut=(()=>{class e{constructor(){this.el=d(V),this.visible=new O,this.observer=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting&&(this.visible.emit(),this.observer.unobserve(this.el.nativeElement))})},{threshold:.1})}ngOnInit(){this.observer.observe(this.el.nativeElement)}ngOnDestroy(){this.observer.disconnect()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=b({type:e,selectors:[["","appLazyLoad",""]],outputs:{visible:"visible"}})}}return e})();var ht=e=>({container:e});function vt(e,o){return this.methodTracking(o)}function Ct(e,o){if(e&1&&(c(0,"mat-icon"),I(1),s()),e&2){let t=r(3);n(),P(" ",t.sortOrder()==="asc"?"arrow_upward":"arrow_downward"," ")}}function _t(e,o){if(e&1){let t=k();c(0,"mat-chip",5),w("click",function(){let a=h(t).$implicit,m=r(2);return v(m.changeSortMethod(a))}),c(1,"mat-icon"),I(2),s(),u(3,Ct,2,1,"mat-icon"),s()}if(e&2){let t=o.$implicit,i=r(2);T("matTooltip","Sort by ",t,""),T("aria-label","Sort by ",t,""),n(2),P(" ",t==="year"?"calendar_today":t==="medium"?"palette":"crop_free"," "),n(),l(i.activeSortMethod()===t?3:-1)}}function xt(e,o){if(e&1&&(c(0,"mat-chip"),M(1,"app-pdf-button",6),s()),e&2){let t=r(2);n(),C("nfts",t.selectedNfts())}}function yt(e,o){if(e&1&&(c(0,"div",1)(1,"mat-chip-listbox"),D(2,_t,4,6,"mat-chip",4,vt,!0),u(4,xt,2,1,"mat-chip"),s()()),e&2){let t=r();n(2),A(t.sortMethods),n(2),l(t.selectedNfts().length?4:-1)}}function bt(e,o){if(e&1&&(c(0,"div",8)(1,"span",11),I(2),s()()),e&2){let t=r(2).$implicit,i=r(2);n(2),$(i.getOrderNumber(t))}}function Mt(e,o){e&1&&M(0,"mat-progress-spinner",9)}function wt(e,o){if(e&1){let t=k();c(0,"mat-grid-tile",7),w("contextmenu",function(a){h(t);let m=r().$implicit,p=r(2);return v(p.toggleNftSelection(a,m))})("click",function(){h(t);let a=r().$implicit,m=r(2);return v(m.handleArtPieceClick(a.tokenId))}),c(1,"mat-card"),u(2,bt,3,1,"div",8)(3,Mt,1,0,"mat-progress-spinner",9),c(4,"img",10),G(5,"async"),w("visible",function(){h(t);let a=r().$implicit,m=r(2);return v(m.onImageVisible(a.tokenId))}),s()()()}if(e&2){let t=r().$implicit,i=r(2);n(2),l(i.isSelected(t)?2:-1),n(),l(i.visibleImages.has(t.tokenId)?-1:3),n(),C("src",i.visibleImages.has(t.tokenId)?U(5,4,i.getImgThumbUrl(t)):null,z)("alt",t.name)}}function It(e,o){if(e&1&&u(0,wt,6,6,"mat-grid-tile"),e&2){let t=o.$implicit,i=r(2);l(i.displayPiece(t)?0:-1)}}function St(e,o){if(e&1&&(c(0,"mat-grid-list",2),D(1,It,1,1,null,null,N().listTracking,!0),s()),e&2){let t=r();C("cols",t.numberOfCols()),n(),A(t.sortedArtPieces())}}function Dt(e,o){e&1&&M(0,"mat-progress-spinner",3)}var de=(()=>{class e{constructor(){this.artworkDomainService=d(Q),this.artworkInfraService=d(ct),this.router=d(Z),this.activatedroute=d(q),this.responsiveService=d(st),this.sessionQuery=d(ot),this.numberOfCols=_(this.responsiveService.displayMobileLayout.value?3:2),this.viewAsWidget=_(!1),this.nftFilters=_({}),this.selectedTokenId=E(),this.sortMethods=Object.values(f),this.dataReady=F(()=>!!this.artPieces()?.length),this.activeSortMethod=x(f.YEAR),this.sortOrder=x(g.DESC),this.sortedArtPieces=F(()=>{switch(this.activeSortMethod()){case f.SIZE:return this.artworkDomainService.sortBySize(this.artPieces(),this.sortOrder());case f.MEDIUM:return this.artworkDomainService.sortByMedium(this.artPieces(),this.sortOrder());case f.YEAR:return this.artworkDomainService.sortByYear(this.artPieces(),this.sortOrder())}}),this.visibleImages=new Set,this.selectedNfts=x([]),this.frontalViewMap=new Map,this.artPieces=J(this.artworkInfraService.getLocalArtPiecesObservable())}ngOnInit(){this.listenYearParamChange()}onImageVisible(t){this.visibleImages.add(t)}toggleNftSelection(t,i){t.preventDefault();let a=this.selectedNfts(),m=a.findIndex(p=>p.tokenId===i.tokenId);if(m===-1)this.selectedNfts.set([...a,i]);else{let p=[...a];p.splice(m,1),this.selectedNfts.set(p)}}isSelected(t){return this.selectedNfts().some(i=>i.tokenId===t.tokenId)}getOrderNumber(t){let i=this.selectedNfts().findIndex(a=>a.tokenId===t.tokenId);return i!==-1?i+1:null}toggleSortOrder(){this.sortOrder.set(this.sortOrder()===g.ASC?g.DESC:g.ASC)}changeSortMethod(t){this.activeSortMethod()===t?this.toggleSortOrder():(this.activeSortMethod.set(t),this.sortOrder.set(g.ASC))}displayPiece(t){return!this.isExcludedByYear(t)&&!this.isExcludedById(t)&&this.isMemoizedFrontalView(t)}getImgThumbUrl(t){return this.artworkInfraService.getAvailableOptimalUrl(t).pipe(S())}handleArtPieceClick(t){this.selectedTokenId.emit(t),this.router.navigate(["/artwork",t])}listTracking(t,i){return i}methodTracking(t){return t}isMemoizedFrontalView(t){if(this.frontalViewMap.has(t.tokenId))return this.frontalViewMap.get(t.tokenId)||!1;{let i=this.artworkDomainService.getArtByTitle(t.name,this.sessionQuery.selectArtPieces),a=this.artworkDomainService.isFrontalView(t,i);return this.frontalViewMap.set(t.tokenId,a),a}}listenYearParamChange(){this.router.events.pipe(S()).subscribe(()=>{if(this.activatedroute.firstChild){let t=this.activatedroute.firstChild.snapshot.queryParamMap.get("years");this.nftFilters().years=t?t.split(","):[]}else if(!this.activatedroute.snapshot.paramMap.get("id")){let t=this.activatedroute.snapshot.queryParamMap.get("years");this.nftFilters().years=t?t.split(","):[]}})}isExcludedById(t){return this.nftFilters()?.idsToExclude?.length?this.nftFilters().idsToExclude.includes(t.tokenId):!1}isExcludedByYear(t){return this.nftFilters().years?.length?!this.nftFilters().years.some(i=>t.raw.metadata.attributes.some(a=>a.trait_type===X.YEAR&&a.value===i)):!1}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=y({type:e,selectors:[["app-art-pieces-list"]],inputs:{numberOfCols:[1,"numberOfCols"],viewAsWidget:[1,"viewAsWidget"],nftFilters:[1,"nftFilters"]},outputs:{selectedTokenId:"selectedTokenId"},decls:4,vars:5,consts:[[3,"ngClass"],[1,"sort-group"],["gutterSize","10","rowHeight","1:1",3,"cols"],["diameter","48","mode","indeterminate"],["color","primary",3,"matTooltip","aria-label"],["color","primary",3,"click","matTooltip","aria-label"],[3,"nfts"],[3,"contextmenu","click"],[1,"overlay"],["diameter","24","mode","indeterminate"],["mat-card-image","","loading","lazy","appLazyLoad","",1,"front-image",3,"visible","src","alt"],[1,"order-number"]],template:function(i,a){i&1&&(c(0,"div",0),u(1,yt,5,1,"div",1)(2,St,3,1,"mat-grid-list",2)(3,Dt,1,0,"mat-progress-spinner",3),s()),i&2&&(C("ngClass",Y(3,ht,!a.viewAsWidget())),n(),l(a.viewAsWidget()?-1:1),n(),l(a.dataReady()?2:3))},dependencies:[H,tt,K,at,nt,dt,it,et,lt,rt,pt,ut,W],styles:["mat-grid-tile[_ngcontent-%COMP%]{cursor:pointer}mat-card[_ngcontent-%COMP%]{position:relative}.container[_ngcontent-%COMP%]{margin-top:0}.sort-group[_ngcontent-%COMP%]{margin-bottom:2em}.sort-desc[_ngcontent-%COMP%]{margin-left:2em;align-items:center;display:flex}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5em;z-index:1;pointer-events:none}.order-number[_ngcontent-%COMP%]{font-weight:700}"]})}}return e})();export{de as a};
