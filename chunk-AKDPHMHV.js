import{a as ue,b as fe}from"./chunk-PANVD2KU.js";import{a as ye}from"./chunk-G3IBR5NJ.js";import{b as oe,d as re,e as ae,j as P}from"./chunk-LE473ATB.js";import{d as me,e as pe}from"./chunk-2LESR65W.js";import{a as de}from"./chunk-BVVLE7M7.js";import{a as ge,b as F,c as he,d as _e,e as ve,f as we,g as Ce,h as Ie,l as xe}from"./chunk-WJL2PQ7Q.js";import"./chunk-ZLX3L3AN.js";import"./chunk-KSYNZQ4A.js";import{i as q,j as E,l as le,m as _,p as O}from"./chunk-LNMUYCJC.js";import{Fa as ce,Ha as B,aa as se,e as V}from"./chunk-2NBOJIJG.js";import{i as ne}from"./chunk-I6SVHXM7.js";import{$b as K,Aa as W,B as H,Ba as M,Dc as Y,Ea as w,Eb as p,Ec as R,Fb as J,I as z,Kb as d,Ob as r,Pb as a,Qb as y,Sb as k,T as G,Ub as c,Vb as h,Yb as S,ab as L,ac as X,bc as Z,cb as o,ea as v,fc as l,gc as T,hb as j,hc as D,ic as ee,jc as te,la as $,m as Q,ma as f,na as g,ob as C,oc as ie,pc as N,q as A,qc as I,rc as x,ub as m}from"./chunk-ASVWRWN4.js";import"./chunk-FK6H3RFT.js";import"./chunk-4X36HX5K.js";function be(t,u){t&1&&(r(0,"mat-icon"),l(1,"download"),a())}function Se(t,u){t&1&&y(0,"mat-progress-spinner",1)}var ke=(()=>{class t{constructor(){this.link=M(),this.name=M(),this.isDownloading=!1}downloadImage(){this.isDownloading=!0,fetch(this.link()).then(e=>{if(!e.ok)throw new Error("Failed to fetch the image.");return e.blob()}).then(e=>{let i=URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download=`${this.name()}.jpg`,n.click(),URL.revokeObjectURL(i)}).catch(e=>{console.error("Error downloading the image:",e)}).finally(()=>{this.isDownloading=!1})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=C({type:t,selectors:[["app-download-button"]],inputs:{link:[1,"link"],name:[1,"name"]},decls:4,vars:5,consts:[["mat-icon-button","","matTooltipPosition","below",3,"click","disabled","matTooltip"],["diameter","24","mode","indeterminate"]],template:function(i,n){i&1&&(r(0,"button",0),I(1,"translate"),c("click",function(){return n.downloadImage()}),m(2,be,2,0,"mat-icon")(3,Se,1,0,"mat-progress-spinner",1),a()),i&2&&(S("matTooltip",x(1,3,"download.hd")),p("disabled",n.isDownloading),o(2),d(n.isDownloading?3:2))},dependencies:[B,F,O,ge,V],encapsulation:2})}}return t})();var Ee=["imageElement"];function Pe(t,u){if(t&1){let e=k();r(0,"div",7),c("click",function(){f(e);let n=h();return g(n.nextNft(-1))}),r(1,"mat-icon",8),l(2," arrow_back "),a()()}}function Oe(t,u){t&1&&(r(0,"mat-icon",5),l(1," fullscreen "),a())}function Fe(t,u){if(t&1){let e=k();r(0,"div",9),c("click",function(){f(e);let n=h();return g(n.nextNft(1))}),r(1,"mat-icon",8),l(2," arrow_forward "),a()()}}var Te=(()=>{class t{constructor(){this.artworkInfraService=v(P),this.nfts=M([]),this.displayIndex=w(0),this.previewImage=w("none"),this.isFullScreen=w(!1),this.displayIndexOutput=W({alias:"displayIndex"}),this.hovering=!1,this.displayArrows=!1,this.displayExpand=!1,this.isImgVisible=!1,R(()=>{let e=this.nfts(),i=this.displayIndex(),n=this.isFullScreen();this.artworkInfraService.getAvailableOptimalUrl(e[i]).subscribe(s=>{this.previewImage.set(n?"none":`url(${s})`)})})}ngOnInit(){this.displayIndex.set(_.getLatestVersionIndex(this.nfts()))}ngOnChanges(e){this.displayArrows=e.nfts.currentValue.length>1,this.isImgVisible=!1,this.displayIndexOutput.emit(_.getLatestVersionIndex(this.nfts())),this.displayIndex.set(_.getLatestVersionIndex(this.nfts()))}setHover(e){this.hovering=e}nextNft(e){this.isImgVisible=!1;let i=(this.displayIndex()+e+this.nfts().length)%this.nfts().length;this.displayIndexOutput.emit(i),this.displayIndex.set(i)}imageLoad(){this.isImgVisible=!0}getQualityImg(e){return _.getNftQualityUrl(e?.image)}handleImageClick(){this.displayExpand?this.enterFullScreen():this.isFullScreen()?this.exitFullScreen():(this.displayExpand=!0,setTimeout(()=>{this.displayExpand=!1},2e3))}handleDoubleClick(){this.isFullScreen()||this.enterFullScreen()}enterFullScreen(){this.isFullScreen.set(!0);let e=this.imageElement.nativeElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}exitFullScreen(){this.isFullScreen.set(!1),document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=C({type:t,selectors:[["app-image-viewer"]],viewQuery:function(i,n){if(i&1&&K(Ee,5),i&2){let s;X(s=Z())&&(n.imageElement=s.first)}},inputs:{nfts:[1,"nfts"]},outputs:{displayIndexOutput:"displayIndex"},features:[$],decls:7,vars:6,consts:[["imageElement",""],[1,"image-viewer",3,"mouseover","mouseleave"],[1,"overlay","left"],[1,"image-container",3,"click","dblclick"],[1,"art-viewer",3,"load","src"],[1,"fullscreen-icon"],[1,"overlay","right"],[1,"overlay","left",3,"click"],[1,"arrow"],[1,"overlay","right",3,"click"]],template:function(i,n){if(i&1){let s=k();r(0,"div",1),c("mouseover",function(){return f(s),g(n.setHover(!0))})("mouseleave",function(){return f(s),g(n.setHover(!1))}),m(1,Pe,3,0,"div",2),r(2,"div",3),c("click",function(){return f(s),g(n.handleImageClick())})("dblclick",function(){return f(s),g(n.handleDoubleClick())}),r(3,"img",4,0),c("load",function(){return f(s),g(n.imageLoad())}),a(),m(5,Oe,2,0,"mat-icon",5),a(),m(6,Fe,3,0,"div",6),a()}i&2&&(o(),d(n.displayArrows&&n.hovering?1:-1),o(2),J("background-image",n.previewImage()),p("src",n.getQualityImg(n.nfts()[n.displayIndex()]),L),o(2),d(n.displayExpand?5:-1),o(),d(n.displayArrows&&n.hovering?6:-1))},dependencies:[O],styles:[".image-viewer[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;width:100%;height:100%}.image-viewer[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{max-width:100%;max-height:100%;background-repeat:no-repeat;background-size:100% 100%;cursor:pointer}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:20%;background-color:#ffffff1a;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1;transition:background-color .3s}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]:hover{background-color:#fff6}.image-viewer[_ngcontent-%COMP%]   .overlay.left[_ngcontent-%COMP%]{left:0}.image-viewer[_ngcontent-%COMP%]   .overlay.right[_ngcontent-%COMP%]{right:0}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:#fff;opacity:.8;transition:transform .3s,opacity .3s}.image-viewer[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]:hover{transform:scale(1.2);opacity:1}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;background-color:#d3d3d3}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .fullscreen-icon[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;z-index:2;display:none;align-items:center;justify-content:center;pointer-events:none}.image-viewer[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]:hover   .fullscreen-icon[_ngcontent-%COMP%]{display:flex}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]{background-color:#000;display:flex;align-items:center;justify-content:center;z-index:3}.image-viewer[_ngcontent-%COMP%]   .fullscreen-active[_ngcontent-%COMP%]   .art-viewer[_ngcontent-%COMP%]{background-color:#000;max-width:100vw;max-height:100vh}"]})}}return t})();function Ae(t,u){if(t&1&&(r(0,"mat-list-item")(1,"a",5),l(2),a()()),t&2){let e=u.$implicit;o(),p("href",e,L),o(),D(" ",e.replace("https://","").replace("http://","").replace("www.","")," ")}}var Ve=(()=>{class t{constructor(e,i){this.data=e,this.dialogRef=i}close(){this.dialogRef.close()}static{this.\u0275fac=function(i){return new(i||t)(j(_e),j(he))}}static{this.\u0275cmp=C({type:t,selectors:[["app-links-modal"]],decls:9,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-line","","target","_blank","rel","noopener noreferrer",3,"href"]],template:function(i,n){i&1&&(r(0,"h1",0),l(1),I(2,"translate"),a(),r(3,"div",1)(4,"mat-list"),m(5,Ae,3,2,"mat-list-item",2),a()(),r(6,"div",3)(7,"button",4),c("click",function(){return n.close()}),l(8,"Close"),a()()),i&2&&(o(),T(x(2,2,"links.view")),o(4),p("ngForOf",n.data.links))},dependencies:[we,Ce,ue,ne,fe,se,Ie,ce,V],encapsulation:2})}}return t})();function Le(t,u){if(t&1){let e=k();r(0,"button",1),I(1,"translate"),c("click",function(){f(e);let n=h();return g(n.openLinksModal())}),r(2,"mat-icon"),l(3,"link"),a()()}t&2&&S("matTooltip",x(1,1,"links.view"))}var Me=(()=>{class t{constructor(){this.artworkInfraService=v(P),this.dialog=v(ve),this.tokenId=M(),this.haveLinks=w(!1),this.rxUrls=me({request:()=>this.tokenId(),loader:({request:e})=>this.artworkInfraService.getLinks(e).pipe(z(),A(i=>i||[]),H(()=>Q([])))}),R(()=>{let i=this.rxUrls.value()?.urls;this.haveLinks.set(Array.isArray(i)&&i.length>0)})}openLinksModal(){let e=this.rxUrls.value();this.dialog.open(Ve,{data:{links:e?.urls}})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=C({type:t,selectors:[["app-links-button"]],inputs:{tokenId:[1,"tokenId"]},decls:1,vars:1,consts:[["mat-icon-button","","matTooltipPosition","below",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","below",3,"click","matTooltip"]],template:function(i,n){i&1&&m(0,Le,4,3,"button",0),i&2&&d(n.haveLinks()?0:-1)},dependencies:[B,F,O,V],encapsulation:2})}}return t})();var De=()=>["/artworks"],Re=t=>({years:t}),Be=t=>[t];function Ue(t,u){t&1&&(y(0,"span",5),I(1,"translate")),t&2&&S("matTooltip",x(1,1,"sold"))}function je(t,u){if(t&1&&y(0,"app-pdf-button",7),t&2){let e=h(2);p("nfts",N(1,Be,e.frontalViewNft()))}}function Ne(t,u){if(t&1&&(r(0,"div",2)(1,"h1")(2,"i"),l(3),r(4,"small"),l(5),a()()(),r(6,"h2")(7,"small")(8,"a",4),l(9),a(),l(10),I(11,"translate"),m(12,Ue,2,3,"span",5),a()(),r(13,"small"),y(14,"app-download-button",6),m(15,je,1,3,"app-pdf-button",7),y(16,"app-links-button",8),a()()),t&2){let e=h();o(3),D("",e.nft().name,". "),o(2),T(e.getViewLabel(e.nft())),o(3),p("routerLink",ie(16,De))("queryParams",N(17,Re,e.getTraitValue(e.nft(),e.validTraits.YEAR))),o(),T(e.getTraitValue(e.nft(),e.validTraits.YEAR)),o(),te(", ",x(11,14,e.getTraitValue(e.nft(),e.validTraits.MEDIUM)),", ",e.getTraitValue(e.nft(),e.validTraits.HEIGHT)," x ",e.getTraitValue(e.nft(),e.validTraits.WIDTH)," ",e.getTraitValue(e.nft(),e.validTraits.UNIT),". "),o(2),d(e.sold(e.nft().tokenId)?12:-1),o(2),p("link",e.getQualityImg(e.nft().image))("name",e.nft().name),o(),d(e.frontalViewNft()?15:-1),o(),p("tokenId",e.nft().tokenId)}}function Ye(t,u){if(t&1&&(r(0,"div",3)(1,"h3"),l(2),a(),r(3,"p"),l(4),a(),r(5,"h4"),l(6),a()()),t&2){let e=h();o(2),T(e.getTraitValue(e.nft(),e.validTraits.PROJECT)),o(2),T(e.nft().description),o(2),T(e.getTraitValue(e.nft(),e.validTraits.DESC_AUTHOR))}}function qe(t,u){if(t&1){let e=k();y(0,"mat-divider"),r(1,"p"),l(2),I(3,"translate"),a(),r(4,"app-art-pieces-list",9),c("selectedTokenId",function(n){f(e);let s=h();return g(s.handleSelectedItem(n))}),a()}if(t&2){let e=h();o(2),ee(" ",x(3,5,"moreOn")," ",e.getTraitValue(e.nft(),e.validTraits.YEAR)," "),o(2),p("viewAsWidget",!0)("numberOfCols",e.numberOfViewMoreColumns)("nftFilters",e.getSameYearListFilter(e.nft()))}}var Nt=(()=>{class t{constructor(){this.router=v(re),this.activatedroute=v(oe),this.artworkInfraService=v(P),this.responsiveService=v(pe),this.validTraits=q,this.displayingIndex=w(0),this.nfts=w([]),this.nft=Y(()=>this.nfts()[this.displayingIndex()]),this.frontalViewNft=w(void 0),this.thereAreMoreInYear=Y(()=>{let e=_.getTraitValue(this.nft(),q.YEAR);return this.artworkInfraService.getNftLenghtByYear(e)>1}),this.numberOfViewMoreColumns=3,this.latestVersionIndex=0,this.responsiveService.displayMobileLayout.subscribe(e=>{this.numberOfViewMoreColumns=e?6:3})}ngOnInit(){this.listenIdParamChange()}listenIdParamChange(){this.activatedroute.paramMap.pipe(A(e=>e.get("id")),G(e=>this.artworkInfraService.getSameArtThanObservable(e))).subscribe(e=>{this.nfts.set(e),this.latestVersionIndex=_.getLatestVersionIndex(this.nfts()),this.displayingIndex.set(this.latestVersionIndex),this.setFrontalView(e)})}getViewLabel(e){switch(this.getTraitValue(e,this.validTraits.IMAGETYPE)){case E.PROGRESS:return`(${E.PROGRESS})`;case E.DETAIL:return`(${E.DETAIL})`;default:return this.displayingIndex()===this.latestVersionIndex?"":`(${E.PROGRESS})`}}getSameYearListFilter(e){let i=this.nfts().map(s=>s.tokenId);return{years:[this.getTraitValue(e,this.validTraits.YEAR)],idsToExclude:i}}getTraitValue(e,i){return _.getTraitValue(e,i)}sold(e){return le.includes(e)}getQualityImg(e){return _.getNftQualityUrl(e)}indexChanged(e){this.displayingIndex.set(e)}setFrontalView(e){let i=e.find(n=>_.isFrontalView(n,e));this.frontalViewNft.set(i)}handleSelectedItem(e){this.router.navigate(["/art",e])}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=C({type:t,selectors:[["app-art-piece"]],decls:5,vars:4,consts:[[1,"container","margin-top"],[1,"fit-width",3,"displayIndex","nfts"],[1,"art-piece-labels"],[1,"art-piece-desc"],[3,"routerLink","queryParams"],[1,"dot",3,"matTooltip"],[3,"link","name"],[3,"nfts"],[3,"tokenId"],[3,"selectedTokenId","viewAsWidget","numberOfCols","nftFilters"]],template:function(i,n){if(i&1&&(r(0,"div",0)(1,"app-image-viewer",1),c("displayIndex",function(b){return n.indexChanged(b)}),a(),m(2,Ne,17,19,"div",2)(3,Ye,7,3,"div",3)(4,qe,5,7),a()),i&2){let s;o(),p("nfts",n.nfts()),o(),d(n.nft()?2:-1),o(),d((s=n.nft().description)!=null&&s.length?3:-1),o(),d(n.thereAreMoreInYear()?4:-1)}},dependencies:[Te,ae,F,ke,xe,Me,de,ye,V],styles:[".dot[_ngcontent-%COMP%]{height:1rem;width:1rem;background-color:#cf2525;border-radius:50%;display:inline-block;margin-left:.8rem;vertical-align:middle}.art-piece-labels[_ngcontent-%COMP%]{padding:8%;text-align:center}.art-piece-desc[_ngcontent-%COMP%]{white-space:pre-line}"]})}}return t})();export{Nt as ArtPieceComponent};
